{"version":3,"kind":"Notebook","sha256":"cc377eeaa5677e4491813828b45851b2cf31362287b8dc142f083c07ab099c99","slug":"two-site-non-resonant","location":"/notebooks/exploration/two_site_non_resonant.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"python3","display_name":"quantum","language":"python"},"authors":[{"id":"Arturo Ruiz","name":"Arturo Ruiz"},{"id":"Gonzalo Usaj","name":"Gonzalo Usaj"}],"github":"https://github.com/Arthor1127/polaritons","affiliations":[{"id":"Instituto Balseiro","name":"Instituto Balseiro"},{"id":"Comisión Nacional de Energía Atómica","name":"Comisión Nacional de Energía Atómica"}],"numbering":{"title":{"offset":2}},"source_url":"https://github.com/Arthor1127/polaritons/blob/main/notebooks/exploration/two_site_non_resonant.ipynb","edit_url":"https://github.com/Arthor1127/polaritons/edit/main/notebooks/exploration/two_site_non_resonant.ipynb","exports":[{"format":"ipynb","filename":"two_site_non_resonant.ipynb","url":"/polaritons/build/two_site_non_resonan-f29f4859554bdc35e54662e833072167.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt \nimport scienceplots \nplt.style.use(['science', 'no-latex', 'notebook'])","key":"pDlNHC690u"},{"type":"outputs","id":"fBJupdC48OGmDGqpbRt4T","children":[],"key":"BuZDyaY7ko"}],"key":"VMZYV6lIsJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_folder_path = \"/home/ruiz/Documents/polaritons/scripts/cpp/\"\ndata = pd.read_csv(data_folder_path + \"output_time.dat\", delimiter= \"\\t\", header = None).iloc[:, :-1]","key":"XGFaWKQ7fR"},{"type":"outputs","id":"TTHikyeTAsa6niGdKoCCa","children":[],"key":"uL8Le38ygW"}],"key":"lSZ4QBLBwT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data.head()","key":"nHIlsEuD5F"},{"type":"outputs","id":"YU-W1191gez8te4tS653w","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n      <th>6</th>\n      <th>7</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.000173</td>\n      <td>0.237630</td>\n      <td>0.516260</td>\n      <td>4.29464</td>\n      <td>7.12856</td>\n      <td>6.80679</td>\n      <td>95.1134</td>\n      <td>0.980671</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.000346</td>\n      <td>0.246060</td>\n      <td>0.511266</td>\n      <td>4.29450</td>\n      <td>7.12704</td>\n      <td>6.82319</td>\n      <td>94.6431</td>\n      <td>1.450300</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"          0         1         2        3        4        5        6         7\n0  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n1  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n2  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n3  0.000173  0.237630  0.516260  4.29464  7.12856  6.80679  95.1134  0.980671\n4  0.000346  0.246060  0.511266  4.29450  7.12704  6.82319  94.6431  1.450300","content_type":"text/plain"}}},"children":[],"key":"iIkKEak9Wh"}],"key":"jp5qgSuYRX"}],"key":"ZG7KUpwpxc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"time = data[0].to_numpy(dtype = float)\nphi1_r = data[1].to_numpy(dtype = float)\nphi1_i = data[2].to_numpy(dtype = float)\nphi2_r = data[3].to_numpy(dtype = float)\nphi2_i = data[4].to_numpy(dtype = float)\nx = data[5].to_numpy(dtype = float)\nv = data[6].to_numpy(dtype = float)\nn = data[7].to_numpy(dtype = float)","key":"scFG3nXMiB"},{"type":"outputs","id":"3FvsAmVU_MWr3agGVGWSY","children":[],"key":"o1HLbUQ5zs"}],"key":"glOnsudcSN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phi1_mod = phi1_r**2 + phi1_i**2\nphi2_mod = phi2_r**2 + phi2_i**2","key":"GrxNuGqf9T"},{"type":"outputs","id":"xB19R0ML-jCZRu9CWlVJp","children":[],"key":"vwdyFcu8NY"}],"key":"YZzfpbo2g5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, phi1_i)\nplt.plot(time, phi1_r)\nplt.plot(time, phi2_i)\nplt.plot(time, phi2_r)\nplt.plot(time, n)\n# plt.xlim(400.0, 410.0)\n# plt.xlim(300, 500)\nplt.xlim(-1.0, 100)","key":"jAQl0kAhvT"},{"type":"outputs","id":"XjiQBkquyzDsdvhlquU58","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"(-1.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"dn3vGXLMnU"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4522b08df6ce8c2fcef940bf8c35ef50","path":"/polaritons/build/4522b08df6ce8c2fcef940bf8c35ef50.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"wPoI7iSoap"}],"key":"U1v3abcVpy"}],"key":"T5BgpmX5R5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = (phi1_r + 1.0j * phi1_i) * (phi2_r -1.0j * phi2_i)*np.exp(-1.0j * 20.0 * time)\n","key":"MLREDHcngn"},{"type":"outputs","id":"JtlP7Tl82F_nMvzFFidtr","children":[],"key":"oEv8ub41mK"}],"key":"lF6NwALXqB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cx_phi1 = phi1_r + 1.0j * phi1_i\ncx_phi2 = phi2_r + 1.0j * phi2_i\n","key":"gls4tidbO1"},{"type":"outputs","id":"UgXN5c6HFetBKx6hEdqTZ","children":[],"key":"LM141X87Lb"}],"key":"SIpoA8MhHo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Parameters\ngamma1 = 1.0\ngamma2 = 1.0\nJ = 0.0\ng = 1.0\nxi = 1.0\nOmega = 20.0\n\n# Compute derivatives according to the model\nphi1_drv = -1.0j * (\n    cx_phi1 * (-1.0j * gamma1 + 1.0j * xi * n) +\n    (J + g * x) * np.exp(+1.0j * Omega * time) * cx_phi2\n)\n\nphi2_drv = -1.0j * (\n    cx_phi2 * (-1.0j * gamma2) +\n    (J + g * x) * np.exp(-1.0j * Omega * time) * cx_phi1\n)","key":"Wi2OuyttTM"},{"type":"outputs","id":"C5jsKcBcKILn3MlFkctVi","children":[],"key":"JONXqOGCKO"}],"key":"ScugjWDWpO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# More accurate derivative for non-uniform timesteps\ndt = np.diff(time)\ndphi1_dt = np.diff(cx_phi1) / dt\n# Add a point to match array sizes\ndphi1_dt = np.append(dphi1_dt, dphi1_dt[-1])","key":"B2NTzwycjm"},{"type":"outputs","id":"ZkO8Ep4Q3PJiA3W3faODX","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_30655/1696355221.py:3: RuntimeWarning: divide by zero encountered in divide\n  dphi1_dt = np.diff(cx_phi1) / dt\n/tmp/ipykernel_30655/1696355221.py:3: RuntimeWarning: invalid value encountered in divide\n  dphi1_dt = np.diff(cx_phi1) / dt\n"},"children":[],"key":"DjBoBeZoUc"}],"key":"d1hfnKjwfj"}],"key":"vY6UkKVz38"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot((phi1_drv - dphi1_dt).imag)\n# plt.xlim(0.0, 0.0025e6)\nplt.xscale('log')","key":"mEnMMwYbeE"},{"type":"outputs","id":"4P95yigNqLipZ7PF8AhwA","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"81b4bfca4076cfa9bd3707c459fedc0a","path":"/polaritons/build/81b4bfca4076cfa9bd3707c459fedc0a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"r4UMT89xnt"}],"key":"sEaXbMCZGw"}],"key":"a8FwTQUKsj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi1_drv.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"ES4hTQMWgy"},{"type":"outputs","id":"s3xUx-GZ1lQwurOadTdbI","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"E0lxhX0mkE"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d6c52c2ada8a3d0a0ec6a1111fcda10b","path":"/polaritons/build/d6c52c2ada8a3d0a0ec6a1111fcda10b.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ZR7PBliAoF"}],"key":"jJNn0SVRyC"}],"key":"pQgSPV59X1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def second_derivative(y, x):\n    \"\"\"\n    Second derivative for non-uniform grids.\n    Preserves array length.\n\n    Parameters\n    ----------\n    y : array_like\n        Function values y(x)\n    x : array_like\n        Grid points (not necessarily uniform)\n\n    Returns\n    -------\n    d2y : np.ndarray\n        Second derivative with same length as y\n    \"\"\"\n    y = np.asarray(y, dtype=float)\n    x = np.asarray(x, dtype=float)\n\n    if len(y) != len(x):\n        raise ValueError(\"x and y must have the same length\")\n    if len(y) < 3:\n        raise ValueError(\"Need at least 3 points\")\n\n    d2y = np.zeros_like(y)\n\n    # Interior points\n    for i in range(1, len(y) - 1):\n        h1 = x[i]   - x[i - 1]\n        h2 = x[i+1] - x[i]\n\n        d2y[i] = 2 * (\n            (y[i+1] - y[i]) / h2 -\n            (y[i]   - y[i-1]) / h1\n        ) / (h1 + h2)\n\n    # Left boundary (forward, non-uniform)\n    h1 = x[1] - x[0]\n    h2 = x[2] - x[1]\n    d2y[0] = 2 * (\n        (y[2] - y[1]) / h2 -\n        (y[1] - y[0]) / h1\n    ) / (h1 + h2)\n\n    # Right boundary (backward, non-uniform)\n    h1 = x[-2] - x[-3]\n    h2 = x[-1] - x[-2]\n    d2y[-1] = 2 * (\n        (y[-1] - y[-2]) / h2 -\n        (y[-2] - y[-3]) / h1\n    ) / (h1 + h2)\n\n    return d2y\n","key":"LtO5BXwCCe"},{"type":"outputs","id":"ovRxqcL3HlD_NPpDs5DTg","children":[],"key":"rk0nFDJfhF"}],"key":"F00L94XUrx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ddot_x = second_derivative(x, time)","key":"WmmsxwLOpr"},{"type":"outputs","id":"1PhdIwu6Svh9lmIckdi4S","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: invalid value encountered in scalar divide\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:35: RuntimeWarning: invalid value encountered in scalar divide\n  (y[i]   - y[i-1]) / h1\n/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: divide by zero encountered in scalar divide\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:35: RuntimeWarning: divide by zero encountered in scalar divide\n  (y[i]   - y[i-1]) / h1\n/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: invalid value encountered in scalar subtract\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:42: RuntimeWarning: invalid value encountered in scalar divide\n  (y[2] - y[1]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:43: RuntimeWarning: invalid value encountered in scalar divide\n  (y[1] - y[0]) / h1\n/tmp/ipykernel_30655/3797952098.py:51: RuntimeWarning: invalid value encountered in scalar divide\n  (y[-2] - y[-3]) / h1\n"},"children":[],"key":"hl4Dnc2iBB"}],"key":"uUVFmstkYv"}],"key":"GAj10iQfmV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = cx_phi1 * np.conj(cx_phi2) * np.exp(-1.0j * 20.0 * time)","key":"HmnjxXXFXv"},{"type":"outputs","id":"wUkqo6fCabQFpsCCJp9dM","children":[],"key":"A9fOCYcApJ"}],"key":"tZUaOP0HDV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_ode =ddot_x + 400.0 * x + 0.05* v","key":"XSqPmYlByC"},{"type":"outputs","id":"uGPoiSablx3EA2XU5hiZY","children":[],"key":"SwNUyiJzXq"}],"key":"T748wgo2Xq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(x_ode)\nplt.xlim(0.0, 0.1e6)","key":"q92l7pQnG7"},{"type":"outputs","id":"FzGReA8sGRQ9RWLYHijA3","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"C18S1CkJsq"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"120d4558008fe3e89de0c8ff6a0938b2","path":"/polaritons/build/120d4558008fe3e89de0c8ff6a0938b2.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ktqaTB8WWn"}],"key":"gdi59jUggc"}],"key":"HOhAlPiWto"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(-2*20.0*0.05*f.real)\nplt.xlim(0.0, 0.1e6)","key":"BIlZjqq1EH"},{"type":"outputs","id":"R4sMpIyAnpHKcAuRbkaAp","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"BYSKfnMuHw"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f44289349c995e03a668bffb2152f1e","path":"/polaritons/build/9f44289349c995e03a668bffb2152f1e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ZXDkOVa78o"}],"key":"wWdYjwsejc"}],"key":"j7KxLDsK2u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(dphi1_dt.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"QUXF3Llzfc"},{"type":"outputs","id":"lWqJytXmTn6PmCP70yM3o","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"RqgxrfNfYF"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eefe40bf5c0396f5fea10a4cea08d910","path":"/polaritons/build/eefe40bf5c0396f5fea10a4cea08d910.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Bgfy3lcq6R"}],"key":"G4aGwsCfxH"}],"key":"dYcwZZ1ejN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi2_drv.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"ELAIM1ioL8"},{"type":"outputs","id":"MNWqq44cEX4O24FZXDwhm","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"SMToQwjRht"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"91dbf8c031055e4bb48ddcb540bcfa61","path":"/polaritons/build/91dbf8c031055e4bb48ddcb540bcfa61.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"wqCSthog9u"}],"key":"zTeX41Akwk"}],"key":"YLTjB44VAE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(dphi2_dt.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"noUkJYuTyf"},{"type":"outputs","id":"IxdZ-vKWM3ugyGhNxKsXH","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"XlCAqVfpaL"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"696b585a07ded37409dff35fe279b75f","path":"/polaritons/build/696b585a07ded37409dff35fe279b75f.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"l2sKqtCHGL"}],"key":"QZ1h9c7bSC"}],"key":"WHdv8ScHDJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dphi2_dt = np.diff(cx_phi2) / dt\n# Add a point to match array sizes\ndphi2_dt = np.append(dphi2_dt, dphi2_dt[-1])","key":"jqucbvrQ2J"},{"type":"outputs","id":"IqWLQqE51KW0HYDEvvdae","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_6129/4041131784.py:1: RuntimeWarning: divide by zero encountered in divide\n  dphi2_dt = np.diff(cx_phi2) / dt\n/tmp/ipykernel_6129/4041131784.py:1: RuntimeWarning: invalid value encountered in divide\n  dphi2_dt = np.diff(cx_phi2) / dt\n"},"children":[],"key":"bm5MicVpV5"}],"key":"LSXt31GX1m"}],"key":"bSOF4zNFDt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot((phi2_drv - dphi2_dt).imag)\nplt.xscale('log')","key":"Ww5b44WXMA"},{"type":"outputs","id":"-9mFHJ_ZBHe6azi9EOtQO","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"504884d1ac0307875f8b6416141ed8f4","path":"/polaritons/build/504884d1ac0307875f8b6416141ed8f4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"JBAMxuu87T"}],"key":"eLDFsdgB5o"}],"key":"UI3WMbIksP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi2_drv.imag)\nplt.ylim(-1.5, 1.5)","key":"ogFcVDHQFO"},{"type":"outputs","id":"uuezK2U12yVxesPjGa_oL","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"(-1.5, 1.5)","content_type":"text/plain"}}},"children":[],"key":"IZREafzMGl"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f4c8c690c39c6a228518f901a910b9c1","path":"/polaritons/build/f4c8c690c39c6a228518f901a910b9c1.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"qxMVgBa0uN"}],"key":"cNS9WV0XoK"}],"key":"ZMlJ4R93Lf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, f.real)\nplt.xlim(70.0, 100.0)","key":"hApJIruMhX"},{"type":"outputs","id":"TfPkZ5G5KX2k1-sjewf4u","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(70.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"pZAQ3zPJQV"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e69abc70a78e438846d2998a3fd2896c","path":"/polaritons/build/e69abc70a78e438846d2998a3fd2896c.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Uzc1xx4Myn"}],"key":"YsDNbiUjI4"}],"key":"gd9EM462V1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"residue = np.gradient(v, time)-400.0 * x - 0.05 * v","key":"JKsjTPThUD"},{"type":"outputs","id":"sjYdyVtLGevS0MRSD_Kdw","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1309: RuntimeWarning: divide by zero encountered in divide\n  a = -(dx2) / (dx1 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1309: RuntimeWarning: invalid value encountered in divide\n  a = -(dx2) / (dx1 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1310: RuntimeWarning: divide by zero encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1310: RuntimeWarning: invalid value encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1311: RuntimeWarning: divide by zero encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1311: RuntimeWarning: invalid value encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1317: RuntimeWarning: invalid value encountered in add\n  out[tuple(slice1)] = a * f[tuple(slice2)] + b * f[tuple(slice3)] \\\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1327: RuntimeWarning: invalid value encountered in scalar divide\n  out[tuple(slice1)] = (f[tuple(slice2)] - f[tuple(slice3)]) / dx_0\n"},"children":[],"key":"anOZ0kZ7Yi"}],"key":"Q5CC4y6Ebg"}],"key":"sKEXbpiXkI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(residue - 2*20*0.05*f.real)\nplt.xlim(0.0, 10rpoy00.0)","key":"VtpFx0gmjo"},{"type":"outputs","id":"_YyFt5HD4-q7lRtldUUqV","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"obmudOWuoj"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"493b27e1086bb882cab7856043acd4b5","path":"/polaritons/build/493b27e1086bb882cab7856043acd4b5.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"S6EUf145IH"}],"key":"mGfhE2vwsM"}],"key":"Lrj1kP2LD6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, x)\nplt.xlim(0.0, 10.0)","key":"wOZQf3e5sn"},{"type":"outputs","id":"sAxpI2tAQo-CR7w-TCWXb","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(0.0, 10.0)","content_type":"text/plain"}}},"children":[],"key":"cLq21BFgVz"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c71c90c7e4d79fca1268e74873bc1283","path":"/polaritons/build/c71c90c7e4d79fca1268e74873bc1283.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Tystfxn6JC"}],"key":"eAR75Qme3N"}],"key":"YxEgdeNlSb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, phi1_mod)\nplt.plot(time, phi2_mod)\nplt.xlim(-0.1, 30)\nplt.ylim(0.0, 10.0)\n# plt.xlim(400, 500","key":"w10mgWTFwg"},{"type":"outputs","id":"XXzNQ5r83FABgWwsc9eML","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(0.0, 10.0)","content_type":"text/plain"}}},"children":[],"key":"QGeqYQ677l"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"21ecdf2cadf557b63b1498e95f8bf86f","path":"/polaritons/build/21ecdf2cadf557b63b1498e95f8bf86f.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"oU0wWtuvV8"}],"key":"xou9paJvO3"}],"key":"wihd5BklYG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"TxELuow91P"},{"type":"outputs","id":"VWGIT8T6DcgIaruAvQL7E","children":[],"key":"vU7siXbGYd"}],"key":"TA3R1M8CrR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, n)","key":"FGzo8mreQO"},{"type":"outputs","id":"IWo5lETmNEBM5rF8eg3mb","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eb58af7de5248df59f92853f6d4fc84a","path":"/polaritons/build/eb58af7de5248df59f92853f6d4fc84a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"NEHBR59iKx"}],"key":"zL57RAoSGG"}],"key":"UxwKckfbFh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mask = time > 300\ntime_new = time[mask]\nphi1_i_new = phi1_i[mask]\nphi1_r_new = phi1_r[mask]","key":"j9EpWnGXxX"},{"type":"outputs","id":"uTSpk9jBZm30wVZJzlTel","children":[],"key":"WXloAPKFSw"}],"key":"OchdRELKCa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"delta_t = time[1]-time[0]","key":"uVlY80DovS"},{"type":"outputs","id":"IPa_A-p0rwJpm2LpFl6CU","children":[],"key":"YfwFOtTZiC"}],"key":"doxPa1Pkuh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.fft import fft, fft2\n\nphi_fft = fft(phi1_r_new +1.0j*phi1_i_new)","key":"Tzwrh3RcUq"},{"type":"outputs","id":"wKyNt9QJo41kTbUeH6vok","children":[],"key":"UzHha17pW8"}],"key":"z2bVslOekA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(np.roll(np.arange(len(phi_fft))/(len(phi_fft) * delta_t), int(len(phi_fft)/2)), abs(phi_fft)**2/len(phi_fft))\nplt.yscale('log')","key":"R9jFOCB9uj"},{"type":"outputs","id":"iRLOwSlx5S6qiXUF9VR8m","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"822091d31f7b6a86f68b6207311ce9ce","path":"/polaritons/build/822091d31f7b6a86f68b6207311ce9ce.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"uG02AGJ25S"}],"key":"i8WRsVscno"}],"key":"fyFIxuK9lj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.xlim(0.0, 20.0)\nplt.plot(time, phi1_mod)\nplt.plot(time, phi2_mod)\n","key":"SAEbditQj1"},{"type":"outputs","id":"V5HtYU8WkAr7PK4ge5OWP","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f203c9389cbc92efdd094e819290774b","path":"/polaritons/build/f203c9389cbc92efdd094e819290774b.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"NEOS2fbK7m"}],"key":"gMj2DITNPV"}],"key":"qimCYmOw0S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, n)\nplt.xlim(400.0, 500.0)\n# plt.yscale('log')","key":"NG44h64Cwv"},{"type":"outputs","id":"cgwHVzlcTwuZSQHyjEngK","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":154,"metadata":{},"data":{"text/plain":{"content":"(400.0, 500.0)","content_type":"text/plain"}}},"children":[],"key":"Eb6YM4b2TW"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"64ed39662032d9c2b545a052319514f4","path":"/polaritons/build/64ed39662032d9c2b545a052319514f4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"m0GIj1tptD"}],"key":"LwarORUsmq"}],"key":"xhks4hNLnI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, x)\nplt.xlim(300.0, 310.0)","key":"D3Qodoh4Rp"},{"type":"outputs","id":"1lsJDWmmF5cFVg9-Kb4Kt","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":156,"metadata":{},"data":{"text/plain":{"content":"(300.0, 310.0)","content_type":"text/plain"}}},"children":[],"key":"cTLh8K1Yme"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a451b8711f4dd291a83e0bceccc3d9f0","path":"/polaritons/build/a451b8711f4dd291a83e0bceccc3d9f0.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"YrnEu8r7k9"}],"key":"dtM17QLpXF"}],"key":"yV5lNrIzOt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_folder_path = \"/home/ruiz/Documents/polaritons/data/processed/\"\ndata = pd.read_csv(data_folder_path + \"nonResonantSweepBuilt.dat\", delimiter= \"\\t\", header = None).iloc[:, :-1]","key":"o5YqxTBAfH"},{"type":"outputs","id":"XoboBiAZyJd4mgie3FXRW","children":[],"key":"HJcDL2JYLz"}],"key":"cVHnr3NVrS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data.head()","key":"ikCS392t21"},{"type":"outputs","id":"f67PZTbDkv6LyrKumqt5M","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>6.174560e-07</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.306122</td>\n      <td>0.000000</td>\n      <td>0.093711</td>\n      <td>0.000000</td>\n      <td>1.530610e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.612245</td>\n      <td>0.000000</td>\n      <td>0.374844</td>\n      <td>0.000000</td>\n      <td>3.061230e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.918367</td>\n      <td>0.121411</td>\n      <td>0.670727</td>\n      <td>0.162630</td>\n      <td>3.292760e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1.224490</td>\n      <td>0.422035</td>\n      <td>0.741610</td>\n      <td>0.632542</td>\n      <td>2.582170e-01</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"          0         1         2         3             4  5\n0  0.000000  0.000000  0.000000  0.000000  6.174560e-07  0\n1  0.306122  0.000000  0.093711  0.000000  1.530610e-01  0\n2  0.612245  0.000000  0.374844  0.000000  3.061230e-01  0\n3  0.918367  0.121411  0.670727  0.162630  3.292760e-01  0\n4  1.224490  0.422035  0.741610  0.632542  2.582170e-01  0","content_type":"text/plain"}}},"children":[],"key":"CGWjEm4xPv"}],"key":"mkG7cTuMHN"}],"key":"uzxMft4Ii3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(data[0], data[2], label = r'$\\frac{\\langle \\vert \\phi_1\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.scatter(data[0], data[1], label = r'$\\frac{\\langle \\vert \\phi_2\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.scatter(data[0], np.sqrt(data[3]/2))\nplt.scatter(data[0], data[4])\nplt.scatter(data[0], data[5])\nplt.plot(data[0], data[2], label = r'$\\frac{\\langle \\vert \\phi_1\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.plot(data[0], data[1], label = r'$\\frac{\\langle \\vert \\phi_2\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.plot(data[0], np.sqrt(data[3]/2))\nplt.plot(data[0], data[4])\nplt.plot(data[0], data[5])\nplt.grid(True)\nplt.xlabel('Magnitud Normalizada')\nplt.ylabel('Potencia')\nplt.legend()\nplt.ylim(0.0, 3.0)\n\n","key":"FanZVa0FVp"},{"type":"outputs","id":"tknASGlvSrn_Daj9YDkaw","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"(0.0, 3.0)","content_type":"text/plain"}}},"children":[],"key":"djqcj9K6qW"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e4a72c821dd4965cc529478b6e90709e","path":"/polaritons/build/e4a72c821dd4965cc529478b6e90709e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"VAGqVdlRev"}],"key":"S5fTzQKGOH"}],"key":"ARVAs4WgNt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"ra7unCWV5B"},{"type":"outputs","id":"0_wFDXJPtIfo6mY2OIAmW","children":[],"key":"M7o2zZBvQG"}],"key":"RCcdEwVh9H"}],"key":"k9ihV9AOIm"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Cpp Notebook","url":"/cpp-notebook","group":"Exploration"},"next":{"title":"Two Site Resonant","url":"/two-site-resonant","group":"Exploration"}}},"domain":"http://localhost:3005"}