{"version":3,"kind":"Notebook","sha256":"cc377eeaa5677e4491813828b45851b2cf31362287b8dc142f083c07ab099c99","slug":"two-site-non-resonant","location":"/book/notebooks/exploration/two_site_non_resonant.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"python3","display_name":"quantum","language":"python"},"github":"https://github.com/Arthor1127/polaritons","numbering":{"title":{"offset":1}},"source_url":"https://github.com/Arthor1127/polaritons/blob/main/book/notebooks/exploration/two_site_non_resonant.ipynb","edit_url":"https://github.com/Arthor1127/polaritons/edit/main/book/notebooks/exploration/two_site_non_resonant.ipynb","exports":[{"format":"ipynb","filename":"two_site_non_resonant.ipynb","url":"/build/two_site_non_resonan-124850d5dfb0c04315295d14ab25308e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt \nimport scienceplots \nplt.style.use(['science', 'no-latex', 'notebook'])","key":"AuzUw1r0h8"},{"type":"outputs","id":"IaFzrpJqDjQ88RfZMiaFa","children":[],"key":"QfOZpgzQ9v"}],"key":"zGGiZWrxNd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_folder_path = \"/home/ruiz/Documents/polaritons/scripts/cpp/\"\ndata = pd.read_csv(data_folder_path + \"output_time.dat\", delimiter= \"\\t\", header = None).iloc[:, :-1]","key":"WB5Wo4IPCl"},{"type":"outputs","id":"Sek5vvdz3F5BvWuF-U6Yq","children":[],"key":"OIi8ijKOCK"}],"key":"mYXPkbEGne"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data.head()","key":"lVim2DLrgP"},{"type":"outputs","id":"wZ2C5G6jyxksroTL8z4cF","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n      <th>6</th>\n      <th>7</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.000173</td>\n      <td>0.237630</td>\n      <td>0.516260</td>\n      <td>4.29464</td>\n      <td>7.12856</td>\n      <td>6.80679</td>\n      <td>95.1134</td>\n      <td>0.980671</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.000346</td>\n      <td>0.246060</td>\n      <td>0.511266</td>\n      <td>4.29450</td>\n      <td>7.12704</td>\n      <td>6.82319</td>\n      <td>94.6431</td>\n      <td>1.450300</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"          0         1         2        3        4        5        6         7\n0  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n1  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n2  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n3  0.000173  0.237630  0.516260  4.29464  7.12856  6.80679  95.1134  0.980671\n4  0.000346  0.246060  0.511266  4.29450  7.12704  6.82319  94.6431  1.450300","content_type":"text/plain"}}},"children":[],"key":"IzMjT4QDNx"}],"key":"eFY111HTHL"}],"key":"S7VF5YDq9B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"time = data[0].to_numpy(dtype = float)\nphi1_r = data[1].to_numpy(dtype = float)\nphi1_i = data[2].to_numpy(dtype = float)\nphi2_r = data[3].to_numpy(dtype = float)\nphi2_i = data[4].to_numpy(dtype = float)\nx = data[5].to_numpy(dtype = float)\nv = data[6].to_numpy(dtype = float)\nn = data[7].to_numpy(dtype = float)","key":"iwz6QEJv1r"},{"type":"outputs","id":"NVSU4lmL9XXUr-wzV7BPU","children":[],"key":"qDuecxLN7a"}],"key":"JPq1FjgPUY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phi1_mod = phi1_r**2 + phi1_i**2\nphi2_mod = phi2_r**2 + phi2_i**2","key":"T9MIbhcK7z"},{"type":"outputs","id":"n3UqSaWvj0gJcJUmDY3Qy","children":[],"key":"GLgsSRzIld"}],"key":"Px6kTMQly8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, phi1_i)\nplt.plot(time, phi1_r)\nplt.plot(time, phi2_i)\nplt.plot(time, phi2_r)\nplt.plot(time, n)\n# plt.xlim(400.0, 410.0)\n# plt.xlim(300, 500)\nplt.xlim(-1.0, 100)","key":"InEBFIY42s"},{"type":"outputs","id":"-5WMHeTpRnA8UTDBLG5tQ","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"(-1.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"bMwltq8Iwb"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4522b08df6ce8c2fcef940bf8c35ef50","path":"/build/4522b08df6ce8c2fcef940bf8c35ef50.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"T5SM5yoZMy"}],"key":"Ot91UiVBoY"}],"key":"yoKirWQsty"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = (phi1_r + 1.0j * phi1_i) * (phi2_r -1.0j * phi2_i)*np.exp(-1.0j * 20.0 * time)\n","key":"BiV0UmXrMr"},{"type":"outputs","id":"hPeuexTScEMfiTd5bIZtB","children":[],"key":"nzFHu1fomS"}],"key":"LXbKN7AC7S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cx_phi1 = phi1_r + 1.0j * phi1_i\ncx_phi2 = phi2_r + 1.0j * phi2_i\n","key":"nQfwuTpaxF"},{"type":"outputs","id":"zVU1yPWUeL9de4Haqt5CA","children":[],"key":"SleeDG6yiw"}],"key":"nVzvGLtGCO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Parameters\ngamma1 = 1.0\ngamma2 = 1.0\nJ = 0.0\ng = 1.0\nxi = 1.0\nOmega = 20.0\n\n# Compute derivatives according to the model\nphi1_drv = -1.0j * (\n    cx_phi1 * (-1.0j * gamma1 + 1.0j * xi * n) +\n    (J + g * x) * np.exp(+1.0j * Omega * time) * cx_phi2\n)\n\nphi2_drv = -1.0j * (\n    cx_phi2 * (-1.0j * gamma2) +\n    (J + g * x) * np.exp(-1.0j * Omega * time) * cx_phi1\n)","key":"JJZqwLMVV3"},{"type":"outputs","id":"2NiBolZIrgcqM_GE1Bumh","children":[],"key":"KtG20i3e2S"}],"key":"Icf3BlL1Rm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# More accurate derivative for non-uniform timesteps\ndt = np.diff(time)\ndphi1_dt = np.diff(cx_phi1) / dt\n# Add a point to match array sizes\ndphi1_dt = np.append(dphi1_dt, dphi1_dt[-1])","key":"zW3T0TQmeG"},{"type":"outputs","id":"kNZ-fhRrh4SwsZDghkzu-","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_30655/1696355221.py:3: RuntimeWarning: divide by zero encountered in divide\n  dphi1_dt = np.diff(cx_phi1) / dt\n/tmp/ipykernel_30655/1696355221.py:3: RuntimeWarning: invalid value encountered in divide\n  dphi1_dt = np.diff(cx_phi1) / dt\n"},"children":[],"key":"duqnABb3cj"}],"key":"HvhucV9Pjq"}],"key":"JXj5r8eoXy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot((phi1_drv - dphi1_dt).imag)\n# plt.xlim(0.0, 0.0025e6)\nplt.xscale('log')","key":"knyK2upOQS"},{"type":"outputs","id":"7xEetk8fh740jUBGSQEoB","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"81b4bfca4076cfa9bd3707c459fedc0a","path":"/build/81b4bfca4076cfa9bd3707c459fedc0a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"hrLrUj6HSi"}],"key":"wR8JS7T3v6"}],"key":"cZRlOXYhWG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi1_drv.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"bXYjAVXqLG"},{"type":"outputs","id":"HVIO00ibpyZYAuy6I_vN_","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"lZsSyWeAiL"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d6c52c2ada8a3d0a0ec6a1111fcda10b","path":"/build/d6c52c2ada8a3d0a0ec6a1111fcda10b.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"wMckupD7S5"}],"key":"fIGj3jYSvM"}],"key":"iNdwSjXEsn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def second_derivative(y, x):\n    \"\"\"\n    Second derivative for non-uniform grids.\n    Preserves array length.\n\n    Parameters\n    ----------\n    y : array_like\n        Function values y(x)\n    x : array_like\n        Grid points (not necessarily uniform)\n\n    Returns\n    -------\n    d2y : np.ndarray\n        Second derivative with same length as y\n    \"\"\"\n    y = np.asarray(y, dtype=float)\n    x = np.asarray(x, dtype=float)\n\n    if len(y) != len(x):\n        raise ValueError(\"x and y must have the same length\")\n    if len(y) < 3:\n        raise ValueError(\"Need at least 3 points\")\n\n    d2y = np.zeros_like(y)\n\n    # Interior points\n    for i in range(1, len(y) - 1):\n        h1 = x[i]   - x[i - 1]\n        h2 = x[i+1] - x[i]\n\n        d2y[i] = 2 * (\n            (y[i+1] - y[i]) / h2 -\n            (y[i]   - y[i-1]) / h1\n        ) / (h1 + h2)\n\n    # Left boundary (forward, non-uniform)\n    h1 = x[1] - x[0]\n    h2 = x[2] - x[1]\n    d2y[0] = 2 * (\n        (y[2] - y[1]) / h2 -\n        (y[1] - y[0]) / h1\n    ) / (h1 + h2)\n\n    # Right boundary (backward, non-uniform)\n    h1 = x[-2] - x[-3]\n    h2 = x[-1] - x[-2]\n    d2y[-1] = 2 * (\n        (y[-1] - y[-2]) / h2 -\n        (y[-2] - y[-3]) / h1\n    ) / (h1 + h2)\n\n    return d2y\n","key":"zd6lNMdYPa"},{"type":"outputs","id":"K75ZFBeMT7Fm2s5LM8CV3","children":[],"key":"WGSUGQj0ys"}],"key":"EOpMfkDBnz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ddot_x = second_derivative(x, time)","key":"sEWyOi4msq"},{"type":"outputs","id":"-4uKwd2QEokn_Irt85TCJ","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: invalid value encountered in scalar divide\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:35: RuntimeWarning: invalid value encountered in scalar divide\n  (y[i]   - y[i-1]) / h1\n/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: divide by zero encountered in scalar divide\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:35: RuntimeWarning: divide by zero encountered in scalar divide\n  (y[i]   - y[i-1]) / h1\n/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: invalid value encountered in scalar subtract\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:42: RuntimeWarning: invalid value encountered in scalar divide\n  (y[2] - y[1]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:43: RuntimeWarning: invalid value encountered in scalar divide\n  (y[1] - y[0]) / h1\n/tmp/ipykernel_30655/3797952098.py:51: RuntimeWarning: invalid value encountered in scalar divide\n  (y[-2] - y[-3]) / h1\n"},"children":[],"key":"jK7gnL6VgQ"}],"key":"JuYKSzVkaZ"}],"key":"y0q8lCBJ5X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = cx_phi1 * np.conj(cx_phi2) * np.exp(-1.0j * 20.0 * time)","key":"PZeCeRhY7S"},{"type":"outputs","id":"FbiQDsrnp4I6Qo21kC0g6","children":[],"key":"ZezghRTo0g"}],"key":"G2PN2Rsrso"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_ode =ddot_x + 400.0 * x + 0.05* v","key":"K7Ej3441oz"},{"type":"outputs","id":"ANTdJO0w37zM4jLK_Uf8P","children":[],"key":"wV1DNugSRh"}],"key":"X4O5s5N9zo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(x_ode)\nplt.xlim(0.0, 0.1e6)","key":"WD9D5x2ST9"},{"type":"outputs","id":"-rn6Q69PIggS9vCXIW9Vy","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"EeGiFjfYpF"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"120d4558008fe3e89de0c8ff6a0938b2","path":"/build/120d4558008fe3e89de0c8ff6a0938b2.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"NX4XV0WKZ2"}],"key":"e99CHzRaGZ"}],"key":"VimQGMElFU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(-2*20.0*0.05*f.real)\nplt.xlim(0.0, 0.1e6)","key":"JZjFL9XbiN"},{"type":"outputs","id":"ON-TzLz3xA2PX2LYLrbVI","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"NoG6Zldn2l"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f44289349c995e03a668bffb2152f1e","path":"/build/9f44289349c995e03a668bffb2152f1e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"iaNxnMZptC"}],"key":"XDAHkq7WhL"}],"key":"rIJnuQMOUK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(dphi1_dt.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"uyydev4RpV"},{"type":"outputs","id":"Jnb83bceYWSARIlujEKJu","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"rTzOeAzcGm"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eefe40bf5c0396f5fea10a4cea08d910","path":"/build/eefe40bf5c0396f5fea10a4cea08d910.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"gAVOO6qb6U"}],"key":"IdjYiP7Rui"}],"key":"idGGBtfdPB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi2_drv.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"HllyQz6o9h"},{"type":"outputs","id":"5difjPIdcswEeSRu2c1ZD","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"B1EiipInS1"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"91dbf8c031055e4bb48ddcb540bcfa61","path":"/build/91dbf8c031055e4bb48ddcb540bcfa61.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"WPzGjn8Z4K"}],"key":"HayZ3YTL7t"}],"key":"ZNEhlyztvW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(dphi2_dt.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"izYp6mhvB1"},{"type":"outputs","id":"9RY5_syByZerAHOoMi4mX","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"jCayfxclUy"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"696b585a07ded37409dff35fe279b75f","path":"/build/696b585a07ded37409dff35fe279b75f.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"gte2rt7LM6"}],"key":"tgZFnyvBlC"}],"key":"HclGOhPez5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dphi2_dt = np.diff(cx_phi2) / dt\n# Add a point to match array sizes\ndphi2_dt = np.append(dphi2_dt, dphi2_dt[-1])","key":"jRAg1JcB8S"},{"type":"outputs","id":"3Nt4O1h15QIxjOB024Uoz","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_6129/4041131784.py:1: RuntimeWarning: divide by zero encountered in divide\n  dphi2_dt = np.diff(cx_phi2) / dt\n/tmp/ipykernel_6129/4041131784.py:1: RuntimeWarning: invalid value encountered in divide\n  dphi2_dt = np.diff(cx_phi2) / dt\n"},"children":[],"key":"aaxDt7SZ07"}],"key":"NIrk6OTliX"}],"key":"ngoYTOLSRD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot((phi2_drv - dphi2_dt).imag)\nplt.xscale('log')","key":"OjKoRW81Kq"},{"type":"outputs","id":"QgkE9g-uSrfNaxPtKML5e","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"504884d1ac0307875f8b6416141ed8f4","path":"/build/504884d1ac0307875f8b6416141ed8f4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"QoaTZ4TJLt"}],"key":"Kgmkoa3X9X"}],"key":"pPawNLIXNb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi2_drv.imag)\nplt.ylim(-1.5, 1.5)","key":"DaqgB1DzYq"},{"type":"outputs","id":"tQpb0ZTLt-e-736uOXfOf","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"(-1.5, 1.5)","content_type":"text/plain"}}},"children":[],"key":"aJKHEOsB0k"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f4c8c690c39c6a228518f901a910b9c1","path":"/build/f4c8c690c39c6a228518f901a910b9c1.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"vn1Y3y2l9e"}],"key":"UEQnAk6jmR"}],"key":"BCoVg9AMk8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, f.real)\nplt.xlim(70.0, 100.0)","key":"LToyV7D8ia"},{"type":"outputs","id":"Jm625oGK1xZWBHgmT9b1Z","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(70.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"foXh4J4ZQR"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e69abc70a78e438846d2998a3fd2896c","path":"/build/e69abc70a78e438846d2998a3fd2896c.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"X2ysOzA9pm"}],"key":"oH805phQYD"}],"key":"PtRMl9HCGl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"residue = np.gradient(v, time)-400.0 * x - 0.05 * v","key":"fE2agAgJgO"},{"type":"outputs","id":"QJmfeMwU-40zJ4xORGq2C","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1309: RuntimeWarning: divide by zero encountered in divide\n  a = -(dx2) / (dx1 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1309: RuntimeWarning: invalid value encountered in divide\n  a = -(dx2) / (dx1 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1310: RuntimeWarning: divide by zero encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1310: RuntimeWarning: invalid value encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1311: RuntimeWarning: divide by zero encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1311: RuntimeWarning: invalid value encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1317: RuntimeWarning: invalid value encountered in add\n  out[tuple(slice1)] = a * f[tuple(slice2)] + b * f[tuple(slice3)] \\\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1327: RuntimeWarning: invalid value encountered in scalar divide\n  out[tuple(slice1)] = (f[tuple(slice2)] - f[tuple(slice3)]) / dx_0\n"},"children":[],"key":"ojHpMQWhVG"}],"key":"WVbli89x0s"}],"key":"q2at1wxD7A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(residue - 2*20*0.05*f.real)\nplt.xlim(0.0, 10rpoy00.0)","key":"ezRh14PRpa"},{"type":"outputs","id":"s8PuA-Qv-OX8JuNsdfi0X","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"vKJ1bcn1xI"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"493b27e1086bb882cab7856043acd4b5","path":"/build/493b27e1086bb882cab7856043acd4b5.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"CG1xj7GfN3"}],"key":"cvWcaOmMGU"}],"key":"OvQHvQMcq7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, x)\nplt.xlim(0.0, 10.0)","key":"bynj61Scm3"},{"type":"outputs","id":"SoPtDnPxOgso66PabH5Wp","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(0.0, 10.0)","content_type":"text/plain"}}},"children":[],"key":"TCMJHH3oBs"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c71c90c7e4d79fca1268e74873bc1283","path":"/build/c71c90c7e4d79fca1268e74873bc1283.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"MMjUiMDOhG"}],"key":"k8oENTUAf6"}],"key":"bihWxktZjv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, phi1_mod)\nplt.plot(time, phi2_mod)\nplt.xlim(-0.1, 30)\nplt.ylim(0.0, 10.0)\n# plt.xlim(400, 500","key":"Ens035GeWS"},{"type":"outputs","id":"MJ4pG_cf8M6l5rC6E5o-A","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(0.0, 10.0)","content_type":"text/plain"}}},"children":[],"key":"t5UBhWg4Sl"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"21ecdf2cadf557b63b1498e95f8bf86f","path":"/build/21ecdf2cadf557b63b1498e95f8bf86f.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"yBNzH63tWt"}],"key":"pl4CCRuYc4"}],"key":"ZRGViuMcT8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"Qej9Y0kDU7"},{"type":"outputs","id":"RZe9nyftREk_ggtNa6sd-","children":[],"key":"kQqSwHw7f7"}],"key":"fDhw9xlhuc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, n)","key":"vEaACFiiXo"},{"type":"outputs","id":"0tHyohwkmpm9EJOJaLllU","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eb58af7de5248df59f92853f6d4fc84a","path":"/build/eb58af7de5248df59f92853f6d4fc84a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ELbZEDKPPd"}],"key":"TwDWuqFVcn"}],"key":"VkYatoBF64"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mask = time > 300\ntime_new = time[mask]\nphi1_i_new = phi1_i[mask]\nphi1_r_new = phi1_r[mask]","key":"airSm32IAr"},{"type":"outputs","id":"bydqA4mwMs3_NHF6832xG","children":[],"key":"Ifssno5uiH"}],"key":"DdZaLrHBm0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"delta_t = time[1]-time[0]","key":"hzL6ifWJLV"},{"type":"outputs","id":"7mhuZtulRdowolFurV69k","children":[],"key":"a71s7k58SV"}],"key":"e2PoKr1sGp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.fft import fft, fft2\n\nphi_fft = fft(phi1_r_new +1.0j*phi1_i_new)","key":"PDgGFy9Fsg"},{"type":"outputs","id":"75m0N681hcr6vUFo7p5XQ","children":[],"key":"JoJxAjLGLj"}],"key":"ebrQCNHb2Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(np.roll(np.arange(len(phi_fft))/(len(phi_fft) * delta_t), int(len(phi_fft)/2)), abs(phi_fft)**2/len(phi_fft))\nplt.yscale('log')","key":"qawNfRhQDf"},{"type":"outputs","id":"SnnapAaDYfJOqkjxiPfu5","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"822091d31f7b6a86f68b6207311ce9ce","path":"/build/822091d31f7b6a86f68b6207311ce9ce.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"OCMXLSu0bI"}],"key":"WjUIcs2dTO"}],"key":"ZQkbSkWtWD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.xlim(0.0, 20.0)\nplt.plot(time, phi1_mod)\nplt.plot(time, phi2_mod)\n","key":"W9f3JkSajZ"},{"type":"outputs","id":"6GAGuoWDRnndRf03_Bce2","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f203c9389cbc92efdd094e819290774b","path":"/build/f203c9389cbc92efdd094e819290774b.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"FFOuAhZrIR"}],"key":"HwOL7rrLh9"}],"key":"SsLxogV8Od"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, n)\nplt.xlim(400.0, 500.0)\n# plt.yscale('log')","key":"agJO36Tdbm"},{"type":"outputs","id":"ddyZYRqOKCWNcD_2W5Z-6","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":154,"metadata":{},"data":{"text/plain":{"content":"(400.0, 500.0)","content_type":"text/plain"}}},"children":[],"key":"DL1dvzZhOU"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"64ed39662032d9c2b545a052319514f4","path":"/build/64ed39662032d9c2b545a052319514f4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"HgvUrH3rvA"}],"key":"el38OZfNOk"}],"key":"fPgdnCuaaP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, x)\nplt.xlim(300.0, 310.0)","key":"BugexE7ljy"},{"type":"outputs","id":"wGMduSS42jRRDSKzuzwUk","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":156,"metadata":{},"data":{"text/plain":{"content":"(300.0, 310.0)","content_type":"text/plain"}}},"children":[],"key":"ue4D470UEp"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a451b8711f4dd291a83e0bceccc3d9f0","path":"/build/a451b8711f4dd291a83e0bceccc3d9f0.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"riJs1N8OiY"}],"key":"NuXoIg0zUt"}],"key":"fERCoCVMrG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_folder_path = \"/home/ruiz/Documents/polaritons/data/processed/\"\ndata = pd.read_csv(data_folder_path + \"nonResonantSweepBuilt.dat\", delimiter= \"\\t\", header = None).iloc[:, :-1]","key":"ciLMPhfXC4"},{"type":"outputs","id":"fHuSWgrQ4MrKzjET47dMF","children":[],"key":"RIrMjxMUWL"}],"key":"t0IA0dRk8d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data.head()","key":"kwjEj6DBqw"},{"type":"outputs","id":"KGURESm0EnI9YDrbHU5sp","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>6.174560e-07</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.306122</td>\n      <td>0.000000</td>\n      <td>0.093711</td>\n      <td>0.000000</td>\n      <td>1.530610e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.612245</td>\n      <td>0.000000</td>\n      <td>0.374844</td>\n      <td>0.000000</td>\n      <td>3.061230e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.918367</td>\n      <td>0.121411</td>\n      <td>0.670727</td>\n      <td>0.162630</td>\n      <td>3.292760e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1.224490</td>\n      <td>0.422035</td>\n      <td>0.741610</td>\n      <td>0.632542</td>\n      <td>2.582170e-01</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"          0         1         2         3             4  5\n0  0.000000  0.000000  0.000000  0.000000  6.174560e-07  0\n1  0.306122  0.000000  0.093711  0.000000  1.530610e-01  0\n2  0.612245  0.000000  0.374844  0.000000  3.061230e-01  0\n3  0.918367  0.121411  0.670727  0.162630  3.292760e-01  0\n4  1.224490  0.422035  0.741610  0.632542  2.582170e-01  0","content_type":"text/plain"}}},"children":[],"key":"CuhJD9HqRd"}],"key":"CbIoR8Z2P9"}],"key":"xW46Bopb2r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(data[0], data[2], label = r'$\\frac{\\langle \\vert \\phi_1\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.scatter(data[0], data[1], label = r'$\\frac{\\langle \\vert \\phi_2\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.scatter(data[0], np.sqrt(data[3]/2))\nplt.scatter(data[0], data[4])\nplt.scatter(data[0], data[5])\nplt.plot(data[0], data[2], label = r'$\\frac{\\langle \\vert \\phi_1\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.plot(data[0], data[1], label = r'$\\frac{\\langle \\vert \\phi_2\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.plot(data[0], np.sqrt(data[3]/2))\nplt.plot(data[0], data[4])\nplt.plot(data[0], data[5])\nplt.grid(True)\nplt.xlabel('Magnitud Normalizada')\nplt.ylabel('Potencia')\nplt.legend()\nplt.ylim(0.0, 3.0)\n\n","key":"BjjoD6Jf1L"},{"type":"outputs","id":"IlAi4Pt5_8LYjITvvmhET","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"(0.0, 3.0)","content_type":"text/plain"}}},"children":[],"key":"igv9rvOhvD"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e4a72c821dd4965cc529478b6e90709e","path":"/build/e4a72c821dd4965cc529478b6e90709e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ryWtlFrFxF"}],"key":"wqlaDeh7ED"}],"key":"ukjHEA7rsF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"FsUz9JbmPQ"},{"type":"outputs","id":"BFdcn85YlQXEfAXETbE1b","children":[],"key":"qqhDNNVJvc"}],"key":"ujm7vwsfRZ"}],"key":"wyDH9xQnFA"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Two Site Resonant","url":"/two-site-resonant","group":"Cavity polaritons coupled to cavity phonons"},"next":{"title":"data","url":"/readme-1","group":"Data"}}},"domain":"http://localhost:3001"}