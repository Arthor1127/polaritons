{"version":3,"kind":"Notebook","sha256":"cc377eeaa5677e4491813828b45851b2cf31362287b8dc142f083c07ab099c99","slug":"two-site-non-resonant","location":"/notebooks/exploration/two_site_non_resonant.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"python3","display_name":"quantum","language":"python"},"github":"https://github.com/Arthor1127/polaritons","numbering":{"title":{"offset":2}},"source_url":"https://github.com/Arthor1127/polaritons/blob/main/notebooks/exploration/two_site_non_resonant.ipynb","edit_url":"https://github.com/Arthor1127/polaritons/edit/main/notebooks/exploration/two_site_non_resonant.ipynb","exports":[{"format":"ipynb","filename":"two_site_non_resonant.ipynb","url":"/build/two_site_non_resonan-f29f4859554bdc35e54662e833072167.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt \nimport scienceplots \nplt.style.use(['science', 'no-latex', 'notebook'])","key":"LGjNpSBOP9"},{"type":"outputs","id":"_xvKtZ4xkyCXX2nBu25Jj","children":[],"key":"epXhX9W2l1"}],"key":"hLMGBSEGQp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_folder_path = \"/home/ruiz/Documents/polaritons/scripts/cpp/\"\ndata = pd.read_csv(data_folder_path + \"output_time.dat\", delimiter= \"\\t\", header = None).iloc[:, :-1]","key":"MrkLOCkd3t"},{"type":"outputs","id":"1lUta74ppbCmhbXJqiP78","children":[],"key":"QL48QknUvP"}],"key":"O5pAFn3LMj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data.head()","key":"K2cCxWHP0O"},{"type":"outputs","id":"yDxUckXi_0Ehmk3b-OtIv","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n      <th>6</th>\n      <th>7</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.000173</td>\n      <td>0.237630</td>\n      <td>0.516260</td>\n      <td>4.29464</td>\n      <td>7.12856</td>\n      <td>6.80679</td>\n      <td>95.1134</td>\n      <td>0.980671</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.000346</td>\n      <td>0.246060</td>\n      <td>0.511266</td>\n      <td>4.29450</td>\n      <td>7.12704</td>\n      <td>6.82319</td>\n      <td>94.6431</td>\n      <td>1.450300</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"          0         1         2        3        4        5        6         7\n0  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n1  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n2  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n3  0.000173  0.237630  0.516260  4.29464  7.12856  6.80679  95.1134  0.980671\n4  0.000346  0.246060  0.511266  4.29450  7.12704  6.82319  94.6431  1.450300","content_type":"text/plain"}}},"children":[],"key":"toCryVgUcK"}],"key":"VgABC57YQZ"}],"key":"GIWebBywQ0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"time = data[0].to_numpy(dtype = float)\nphi1_r = data[1].to_numpy(dtype = float)\nphi1_i = data[2].to_numpy(dtype = float)\nphi2_r = data[3].to_numpy(dtype = float)\nphi2_i = data[4].to_numpy(dtype = float)\nx = data[5].to_numpy(dtype = float)\nv = data[6].to_numpy(dtype = float)\nn = data[7].to_numpy(dtype = float)","key":"hfdJYKk2ah"},{"type":"outputs","id":"EUh05zoXid2mbzYq7EMmi","children":[],"key":"jXQ9y6zIAN"}],"key":"bvQiR74H01"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phi1_mod = phi1_r**2 + phi1_i**2\nphi2_mod = phi2_r**2 + phi2_i**2","key":"S0Zns4prdT"},{"type":"outputs","id":"CZhtjpsOQrsairy_4VbEv","children":[],"key":"ojeBGheWJw"}],"key":"f36hEpjJSv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, phi1_i)\nplt.plot(time, phi1_r)\nplt.plot(time, phi2_i)\nplt.plot(time, phi2_r)\nplt.plot(time, n)\n# plt.xlim(400.0, 410.0)\n# plt.xlim(300, 500)\nplt.xlim(-1.0, 100)","key":"JlX6er4Z0C"},{"type":"outputs","id":"emEcD7dc4fzLU9tF0kuym","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"(-1.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"ewBixlxVDu"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4522b08df6ce8c2fcef940bf8c35ef50","path":"/build/4522b08df6ce8c2fcef940bf8c35ef50.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ZEfPOyjycJ"}],"key":"Tr867rUIoU"}],"key":"WBmc1OB9hl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = (phi1_r + 1.0j * phi1_i) * (phi2_r -1.0j * phi2_i)*np.exp(-1.0j * 20.0 * time)\n","key":"U9z1STsBUh"},{"type":"outputs","id":"CnRFck_13j2gOFqKSMhyI","children":[],"key":"G2V5JrBYsq"}],"key":"kGywbkjiC9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cx_phi1 = phi1_r + 1.0j * phi1_i\ncx_phi2 = phi2_r + 1.0j * phi2_i\n","key":"WbqG97XgvZ"},{"type":"outputs","id":"ArSFCD86kuuolTqsbvXJw","children":[],"key":"v3pUiMHnNY"}],"key":"pElmG0QvcA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Parameters\ngamma1 = 1.0\ngamma2 = 1.0\nJ = 0.0\ng = 1.0\nxi = 1.0\nOmega = 20.0\n\n# Compute derivatives according to the model\nphi1_drv = -1.0j * (\n    cx_phi1 * (-1.0j * gamma1 + 1.0j * xi * n) +\n    (J + g * x) * np.exp(+1.0j * Omega * time) * cx_phi2\n)\n\nphi2_drv = -1.0j * (\n    cx_phi2 * (-1.0j * gamma2) +\n    (J + g * x) * np.exp(-1.0j * Omega * time) * cx_phi1\n)","key":"LSb0BdULke"},{"type":"outputs","id":"VAa3ZPC8CQVzoNQbkQfeO","children":[],"key":"nNcNdkN59J"}],"key":"MW2nBoKqxZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# More accurate derivative for non-uniform timesteps\ndt = np.diff(time)\ndphi1_dt = np.diff(cx_phi1) / dt\n# Add a point to match array sizes\ndphi1_dt = np.append(dphi1_dt, dphi1_dt[-1])","key":"CZNx6prnk1"},{"type":"outputs","id":"VyvSDGR4TI8FixEcrMPhN","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_30655/1696355221.py:3: RuntimeWarning: divide by zero encountered in divide\n  dphi1_dt = np.diff(cx_phi1) / dt\n/tmp/ipykernel_30655/1696355221.py:3: RuntimeWarning: invalid value encountered in divide\n  dphi1_dt = np.diff(cx_phi1) / dt\n"},"children":[],"key":"svR6FXvzQV"}],"key":"oGHzjVOsJs"}],"key":"Bnq4GPaDT4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot((phi1_drv - dphi1_dt).imag)\n# plt.xlim(0.0, 0.0025e6)\nplt.xscale('log')","key":"aEgzGm5lms"},{"type":"outputs","id":"WAYiNoBJtaLq3ojv8qGyI","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"81b4bfca4076cfa9bd3707c459fedc0a","path":"/build/81b4bfca4076cfa9bd3707c459fedc0a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"s0XU0dKQWB"}],"key":"zCL2K3nSM2"}],"key":"CLaYqvHwYL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi1_drv.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"WXKTtsNKlS"},{"type":"outputs","id":"FW_ewRB3tHPrUrqyIgtsI","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"prJyRHT1pz"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d6c52c2ada8a3d0a0ec6a1111fcda10b","path":"/build/d6c52c2ada8a3d0a0ec6a1111fcda10b.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ZuSXdtVMiT"}],"key":"xcqW8dpl4P"}],"key":"KSi3uXa4XO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def second_derivative(y, x):\n    \"\"\"\n    Second derivative for non-uniform grids.\n    Preserves array length.\n\n    Parameters\n    ----------\n    y : array_like\n        Function values y(x)\n    x : array_like\n        Grid points (not necessarily uniform)\n\n    Returns\n    -------\n    d2y : np.ndarray\n        Second derivative with same length as y\n    \"\"\"\n    y = np.asarray(y, dtype=float)\n    x = np.asarray(x, dtype=float)\n\n    if len(y) != len(x):\n        raise ValueError(\"x and y must have the same length\")\n    if len(y) < 3:\n        raise ValueError(\"Need at least 3 points\")\n\n    d2y = np.zeros_like(y)\n\n    # Interior points\n    for i in range(1, len(y) - 1):\n        h1 = x[i]   - x[i - 1]\n        h2 = x[i+1] - x[i]\n\n        d2y[i] = 2 * (\n            (y[i+1] - y[i]) / h2 -\n            (y[i]   - y[i-1]) / h1\n        ) / (h1 + h2)\n\n    # Left boundary (forward, non-uniform)\n    h1 = x[1] - x[0]\n    h2 = x[2] - x[1]\n    d2y[0] = 2 * (\n        (y[2] - y[1]) / h2 -\n        (y[1] - y[0]) / h1\n    ) / (h1 + h2)\n\n    # Right boundary (backward, non-uniform)\n    h1 = x[-2] - x[-3]\n    h2 = x[-1] - x[-2]\n    d2y[-1] = 2 * (\n        (y[-1] - y[-2]) / h2 -\n        (y[-2] - y[-3]) / h1\n    ) / (h1 + h2)\n\n    return d2y\n","key":"KV4SSfRYCc"},{"type":"outputs","id":"vzZHLsZMYNJDqXF9yyOcX","children":[],"key":"oHX6GV0v74"}],"key":"xM2qZ5Vkg7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ddot_x = second_derivative(x, time)","key":"yaYVyZDjgv"},{"type":"outputs","id":"lWvvGP3Odad7z0cX1pVxr","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: invalid value encountered in scalar divide\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:35: RuntimeWarning: invalid value encountered in scalar divide\n  (y[i]   - y[i-1]) / h1\n/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: divide by zero encountered in scalar divide\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:35: RuntimeWarning: divide by zero encountered in scalar divide\n  (y[i]   - y[i-1]) / h1\n/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: invalid value encountered in scalar subtract\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:42: RuntimeWarning: invalid value encountered in scalar divide\n  (y[2] - y[1]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:43: RuntimeWarning: invalid value encountered in scalar divide\n  (y[1] - y[0]) / h1\n/tmp/ipykernel_30655/3797952098.py:51: RuntimeWarning: invalid value encountered in scalar divide\n  (y[-2] - y[-3]) / h1\n"},"children":[],"key":"nwu1wuvbJb"}],"key":"acTzDXdC1U"}],"key":"YI62pL9h1L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = cx_phi1 * np.conj(cx_phi2) * np.exp(-1.0j * 20.0 * time)","key":"Lde7Mb1GMa"},{"type":"outputs","id":"jnfHH7KJPl07XvMjpyc0n","children":[],"key":"pm0rHwxS1b"}],"key":"a7YBn4Quh2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_ode =ddot_x + 400.0 * x + 0.05* v","key":"QGnw7QuQGm"},{"type":"outputs","id":"mtzG4TtEdrFWMw4tSgzYd","children":[],"key":"Yn0NO0nnBw"}],"key":"Vk8sQxr3tM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(x_ode)\nplt.xlim(0.0, 0.1e6)","key":"mhOjR5dLUT"},{"type":"outputs","id":"dUraqaaqvzP_e_4vCC4gX","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"i7LoUPJDyu"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"120d4558008fe3e89de0c8ff6a0938b2","path":"/build/120d4558008fe3e89de0c8ff6a0938b2.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"cWxbwxrK6z"}],"key":"moDH940k5L"}],"key":"zlZSQauosh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(-2*20.0*0.05*f.real)\nplt.xlim(0.0, 0.1e6)","key":"Shod7SYfOR"},{"type":"outputs","id":"JmM1QE_Uw3p9BupVW-yG4","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"E2jFl7UDag"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f44289349c995e03a668bffb2152f1e","path":"/build/9f44289349c995e03a668bffb2152f1e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"jjL8tqZdPO"}],"key":"BRTu3pUQAU"}],"key":"bT4cRPDyNA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(dphi1_dt.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"a8NTTpcsKa"},{"type":"outputs","id":"pzbGC2qsMpIxQyDyse9Ds","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"gRDFJAV3KZ"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eefe40bf5c0396f5fea10a4cea08d910","path":"/build/eefe40bf5c0396f5fea10a4cea08d910.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"N6IwtaWKti"}],"key":"qC5sj2RoAi"}],"key":"jITv9tNCj2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi2_drv.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"EMnChHJlTR"},{"type":"outputs","id":"zgjmDGyBocxN4KDGMRmrI","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"vgX5mNIR0O"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"91dbf8c031055e4bb48ddcb540bcfa61","path":"/build/91dbf8c031055e4bb48ddcb540bcfa61.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"sLgkFoiB9X"}],"key":"gEo2cPY7hO"}],"key":"NBHDAYLp15"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(dphi2_dt.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"QeUCAgJVVH"},{"type":"outputs","id":"Uim2umQwdjYwf2JMsfhFl","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"XJ6qCbFsav"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"696b585a07ded37409dff35fe279b75f","path":"/build/696b585a07ded37409dff35fe279b75f.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"N8chvQfgPK"}],"key":"if2WvLxKBe"}],"key":"g5yyNuMCsV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dphi2_dt = np.diff(cx_phi2) / dt\n# Add a point to match array sizes\ndphi2_dt = np.append(dphi2_dt, dphi2_dt[-1])","key":"OL72FtnOGt"},{"type":"outputs","id":"AVruYGbE9Olv31AfzmvxD","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_6129/4041131784.py:1: RuntimeWarning: divide by zero encountered in divide\n  dphi2_dt = np.diff(cx_phi2) / dt\n/tmp/ipykernel_6129/4041131784.py:1: RuntimeWarning: invalid value encountered in divide\n  dphi2_dt = np.diff(cx_phi2) / dt\n"},"children":[],"key":"UbQ0L5kQJB"}],"key":"Vimm13IMRs"}],"key":"QN0aSrRMAB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot((phi2_drv - dphi2_dt).imag)\nplt.xscale('log')","key":"rTuoLQfndj"},{"type":"outputs","id":"XjQnxzquoS6yecipwi99E","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"504884d1ac0307875f8b6416141ed8f4","path":"/build/504884d1ac0307875f8b6416141ed8f4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"g6JWMoTw0P"}],"key":"fTq9fnVsPi"}],"key":"pWmsROgTX3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi2_drv.imag)\nplt.ylim(-1.5, 1.5)","key":"uCgDEVwXTY"},{"type":"outputs","id":"mfomuNARHW2_vLKZuxXkb","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"(-1.5, 1.5)","content_type":"text/plain"}}},"children":[],"key":"ZmNlurbKlB"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f4c8c690c39c6a228518f901a910b9c1","path":"/build/f4c8c690c39c6a228518f901a910b9c1.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"l1129ICsui"}],"key":"qafKgO9ARM"}],"key":"mb8lRYpKpu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, f.real)\nplt.xlim(70.0, 100.0)","key":"JGHy0nqjAi"},{"type":"outputs","id":"Gpl-UyBtdYeuvTLUnRecl","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(70.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"cc5v0A2B6d"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e69abc70a78e438846d2998a3fd2896c","path":"/build/e69abc70a78e438846d2998a3fd2896c.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"JYTTKxiukQ"}],"key":"ernfqempsh"}],"key":"slJTgAjsUd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"residue = np.gradient(v, time)-400.0 * x - 0.05 * v","key":"soxL1PyY3p"},{"type":"outputs","id":"WSLqtUyi-n3DpjKlLvVTP","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1309: RuntimeWarning: divide by zero encountered in divide\n  a = -(dx2) / (dx1 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1309: RuntimeWarning: invalid value encountered in divide\n  a = -(dx2) / (dx1 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1310: RuntimeWarning: divide by zero encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1310: RuntimeWarning: invalid value encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1311: RuntimeWarning: divide by zero encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1311: RuntimeWarning: invalid value encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1317: RuntimeWarning: invalid value encountered in add\n  out[tuple(slice1)] = a * f[tuple(slice2)] + b * f[tuple(slice3)] \\\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1327: RuntimeWarning: invalid value encountered in scalar divide\n  out[tuple(slice1)] = (f[tuple(slice2)] - f[tuple(slice3)]) / dx_0\n"},"children":[],"key":"pQPFKe3VJz"}],"key":"Jf1I03rnM8"}],"key":"gMyLPgK2OO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(residue - 2*20*0.05*f.real)\nplt.xlim(0.0, 10rpoy00.0)","key":"z1KfwbSj7a"},{"type":"outputs","id":"zzvRD7mkrz_Lz1eBgGFZq","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"rK4aTOdLjh"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"493b27e1086bb882cab7856043acd4b5","path":"/build/493b27e1086bb882cab7856043acd4b5.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"mfht3RVUvr"}],"key":"YOpUyOUeHf"}],"key":"bBYAWIjTwM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, x)\nplt.xlim(0.0, 10.0)","key":"QLStMlUDDG"},{"type":"outputs","id":"PH6E76nlOMlz_Ti8WA1gS","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(0.0, 10.0)","content_type":"text/plain"}}},"children":[],"key":"kiucekYAku"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c71c90c7e4d79fca1268e74873bc1283","path":"/build/c71c90c7e4d79fca1268e74873bc1283.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"BCuntxjKOq"}],"key":"jcGfJvI7oD"}],"key":"RwPz1VKhgZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, phi1_mod)\nplt.plot(time, phi2_mod)\nplt.xlim(-0.1, 30)\nplt.ylim(0.0, 10.0)\n# plt.xlim(400, 500","key":"tnWhc4iSJd"},{"type":"outputs","id":"JNY0U1hOpazuXQhERMgtS","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(0.0, 10.0)","content_type":"text/plain"}}},"children":[],"key":"mIwMt5jVco"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"21ecdf2cadf557b63b1498e95f8bf86f","path":"/build/21ecdf2cadf557b63b1498e95f8bf86f.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"FuKBwZ9yav"}],"key":"P1SHH7vjJP"}],"key":"ukRR8YV25K"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"nZjo1ofa7r"},{"type":"outputs","id":"we5eT-XBoKpWEGvsUfgZf","children":[],"key":"nK0r1W50FZ"}],"key":"tKuuYCXSUQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, n)","key":"vj2BpE0Z77"},{"type":"outputs","id":"4-cNjJSllIwd98wEqYl_5","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eb58af7de5248df59f92853f6d4fc84a","path":"/build/eb58af7de5248df59f92853f6d4fc84a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"rwEu2UML39"}],"key":"ofioRc92zc"}],"key":"tBBCTg1Ffh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mask = time > 300\ntime_new = time[mask]\nphi1_i_new = phi1_i[mask]\nphi1_r_new = phi1_r[mask]","key":"RdNpOBMXF9"},{"type":"outputs","id":"VMkjRUSvG_5Mvo6eypFcs","children":[],"key":"laCEtnnGQx"}],"key":"gvAVa3osn0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"delta_t = time[1]-time[0]","key":"wXW8aYvlqp"},{"type":"outputs","id":"SGSOFYbRlh58ajZokQfJU","children":[],"key":"buHTMaKGOf"}],"key":"IgmbgVs7Ph"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.fft import fft, fft2\n\nphi_fft = fft(phi1_r_new +1.0j*phi1_i_new)","key":"M6YOLqEknj"},{"type":"outputs","id":"KU8OMt5f2AYidBuGbxwjY","children":[],"key":"bykeRBhaJs"}],"key":"hpRhgfKe4h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(np.roll(np.arange(len(phi_fft))/(len(phi_fft) * delta_t), int(len(phi_fft)/2)), abs(phi_fft)**2/len(phi_fft))\nplt.yscale('log')","key":"HsvehgnpuV"},{"type":"outputs","id":"zR24he6hxbtJjODs5JJAT","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"822091d31f7b6a86f68b6207311ce9ce","path":"/build/822091d31f7b6a86f68b6207311ce9ce.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"K3P2DRn4j7"}],"key":"wtzIeFX7Xl"}],"key":"TX3oO7o92S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.xlim(0.0, 20.0)\nplt.plot(time, phi1_mod)\nplt.plot(time, phi2_mod)\n","key":"J1iPF0WMEV"},{"type":"outputs","id":"wPNlt1Dzab9I-DFILV6H4","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f203c9389cbc92efdd094e819290774b","path":"/build/f203c9389cbc92efdd094e819290774b.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"noOS03XPTc"}],"key":"SU0hhSa1Z9"}],"key":"c96GDbD5m9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, n)\nplt.xlim(400.0, 500.0)\n# plt.yscale('log')","key":"sYme78JQ5g"},{"type":"outputs","id":"9v2_PcFnWP66NL-3RFJvb","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":154,"metadata":{},"data":{"text/plain":{"content":"(400.0, 500.0)","content_type":"text/plain"}}},"children":[],"key":"KWo57Z4m9U"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"64ed39662032d9c2b545a052319514f4","path":"/build/64ed39662032d9c2b545a052319514f4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"QWLnln978u"}],"key":"VnbncsBTtA"}],"key":"ICiwPir3Uq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, x)\nplt.xlim(300.0, 310.0)","key":"JxPA9RNOGd"},{"type":"outputs","id":"XfGonRPwRZwBLnAKOyPrS","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":156,"metadata":{},"data":{"text/plain":{"content":"(300.0, 310.0)","content_type":"text/plain"}}},"children":[],"key":"s4EpFVzgj9"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a451b8711f4dd291a83e0bceccc3d9f0","path":"/build/a451b8711f4dd291a83e0bceccc3d9f0.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"hfY5xur525"}],"key":"RQwnxAwMYk"}],"key":"jh9E0YuvQo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_folder_path = \"/home/ruiz/Documents/polaritons/data/processed/\"\ndata = pd.read_csv(data_folder_path + \"nonResonantSweepBuilt.dat\", delimiter= \"\\t\", header = None).iloc[:, :-1]","key":"J1AxAVkGkJ"},{"type":"outputs","id":"V5e6-Ht2Cuo64tnwuNWwl","children":[],"key":"CShRl9hAG1"}],"key":"cygOtfyzuy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data.head()","key":"q4qMngdhH9"},{"type":"outputs","id":"cmIPp_MMSuNmLn_VodblM","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>6.174560e-07</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.306122</td>\n      <td>0.000000</td>\n      <td>0.093711</td>\n      <td>0.000000</td>\n      <td>1.530610e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.612245</td>\n      <td>0.000000</td>\n      <td>0.374844</td>\n      <td>0.000000</td>\n      <td>3.061230e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.918367</td>\n      <td>0.121411</td>\n      <td>0.670727</td>\n      <td>0.162630</td>\n      <td>3.292760e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1.224490</td>\n      <td>0.422035</td>\n      <td>0.741610</td>\n      <td>0.632542</td>\n      <td>2.582170e-01</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"          0         1         2         3             4  5\n0  0.000000  0.000000  0.000000  0.000000  6.174560e-07  0\n1  0.306122  0.000000  0.093711  0.000000  1.530610e-01  0\n2  0.612245  0.000000  0.374844  0.000000  3.061230e-01  0\n3  0.918367  0.121411  0.670727  0.162630  3.292760e-01  0\n4  1.224490  0.422035  0.741610  0.632542  2.582170e-01  0","content_type":"text/plain"}}},"children":[],"key":"iv9IC2gBL8"}],"key":"oyYTMYrfBM"}],"key":"MNT8UNMTOR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(data[0], data[2], label = r'$\\frac{\\langle \\vert \\phi_1\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.scatter(data[0], data[1], label = r'$\\frac{\\langle \\vert \\phi_2\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.scatter(data[0], np.sqrt(data[3]/2))\nplt.scatter(data[0], data[4])\nplt.scatter(data[0], data[5])\nplt.plot(data[0], data[2], label = r'$\\frac{\\langle \\vert \\phi_1\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.plot(data[0], data[1], label = r'$\\frac{\\langle \\vert \\phi_2\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.plot(data[0], np.sqrt(data[3]/2))\nplt.plot(data[0], data[4])\nplt.plot(data[0], data[5])\nplt.grid(True)\nplt.xlabel('Magnitud Normalizada')\nplt.ylabel('Potencia')\nplt.legend()\nplt.ylim(0.0, 3.0)\n\n","key":"siKRNtL6P7"},{"type":"outputs","id":"OsYL035TWvbcul40rcIAu","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"(0.0, 3.0)","content_type":"text/plain"}}},"children":[],"key":"Fz3zbCtyl9"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e4a72c821dd4965cc529478b6e90709e","path":"/build/e4a72c821dd4965cc529478b6e90709e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"v95YkPe4B5"}],"key":"aQ8i1SE7zi"}],"key":"UoJJRbuxON"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"k8WN4Q3VyJ"},{"type":"outputs","id":"aq_vEtbeAL3U23Kz1EVvf","children":[],"key":"uxWJ7utXNe"}],"key":"DPmZgrLJ1b"}],"key":"qLlCzQAW3l"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Cpp Notebook","url":"/cpp-notebook","group":"Exploration"},"next":{"title":"Two Site Resonant","url":"/two-site-resonant","group":"Exploration"}}},"domain":"http://localhost:3002"}