{"version":3,"kind":"Notebook","sha256":"cc377eeaa5677e4491813828b45851b2cf31362287b8dc142f083c07ab099c99","slug":"two-site-non-resonant","location":"/notebooks/exploration/two_site_non_resonant.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"python3","display_name":"quantum","language":"python"},"authors":[{"id":"Arturo Ruiz","name":"Arturo Ruiz"},{"id":"Gonzalo Usaj","name":"Gonzalo Usaj"}],"github":"https://github.com/Arthor1127/polaritons","affiliations":[{"id":"Instituto Balseiro","name":"Instituto Balseiro"},{"id":"Comisión Nacional de Energía Atómica","name":"Comisión Nacional de Energía Atómica"}],"numbering":{"title":{"offset":2}},"source_url":"https://github.com/Arthor1127/polaritons/blob/main/notebooks/exploration/two_site_non_resonant.ipynb","edit_url":"https://github.com/Arthor1127/polaritons/edit/main/notebooks/exploration/two_site_non_resonant.ipynb","exports":[{"format":"ipynb","filename":"two_site_non_resonant.ipynb","url":"/build/two_site_non_resonan-f29f4859554bdc35e54662e833072167.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt \nimport scienceplots \nplt.style.use(['science', 'no-latex', 'notebook'])","key":"dBpYNvLOGw"},{"type":"outputs","id":"-stIxVBX9Jd9MB3GWUAww","children":[],"key":"K2guM3mo91"}],"key":"jqw3dd64AD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_folder_path = \"/home/ruiz/Documents/polaritons/scripts/cpp/\"\ndata = pd.read_csv(data_folder_path + \"output_time.dat\", delimiter= \"\\t\", header = None).iloc[:, :-1]","key":"N0l6vbtlgZ"},{"type":"outputs","id":"Fmk6Tp-Qsz7MgEtrX1eCg","children":[],"key":"bwgPuww0dX"}],"key":"qYjztmznuV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data.head()","key":"u8Uo1OS9Lf"},{"type":"outputs","id":"5U9h5iUPq6Q3ZatNUEjx8","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n      <th>6</th>\n      <th>7</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.000173</td>\n      <td>0.237630</td>\n      <td>0.516260</td>\n      <td>4.29464</td>\n      <td>7.12856</td>\n      <td>6.80679</td>\n      <td>95.1134</td>\n      <td>0.980671</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.000346</td>\n      <td>0.246060</td>\n      <td>0.511266</td>\n      <td>4.29450</td>\n      <td>7.12704</td>\n      <td>6.82319</td>\n      <td>94.6431</td>\n      <td>1.450300</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"          0         1         2        3        4        5        6         7\n0  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n1  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n2  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n3  0.000173  0.237630  0.516260  4.29464  7.12856  6.80679  95.1134  0.980671\n4  0.000346  0.246060  0.511266  4.29450  7.12704  6.82319  94.6431  1.450300","content_type":"text/plain"}}},"children":[],"key":"e9w50OSprL"}],"key":"demBFZV4Vb"}],"key":"E7bNXpvimw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"time = data[0].to_numpy(dtype = float)\nphi1_r = data[1].to_numpy(dtype = float)\nphi1_i = data[2].to_numpy(dtype = float)\nphi2_r = data[3].to_numpy(dtype = float)\nphi2_i = data[4].to_numpy(dtype = float)\nx = data[5].to_numpy(dtype = float)\nv = data[6].to_numpy(dtype = float)\nn = data[7].to_numpy(dtype = float)","key":"ciKCcZ0ztv"},{"type":"outputs","id":"eEoO8JiGYRPyUWP3DnbAB","children":[],"key":"ZwnTcUNIU2"}],"key":"ILBNyUUQjn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phi1_mod = phi1_r**2 + phi1_i**2\nphi2_mod = phi2_r**2 + phi2_i**2","key":"RYXZgb8XX9"},{"type":"outputs","id":"NBKu74g9VAIpOUbS4DsAk","children":[],"key":"THhyYmWTzZ"}],"key":"YFEnmIQcws"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, phi1_i)\nplt.plot(time, phi1_r)\nplt.plot(time, phi2_i)\nplt.plot(time, phi2_r)\nplt.plot(time, n)\n# plt.xlim(400.0, 410.0)\n# plt.xlim(300, 500)\nplt.xlim(-1.0, 100)","key":"ENJZMigQVo"},{"type":"outputs","id":"iHJZxE1SjKPERYJXSoieF","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"(-1.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"gk0qpoOx3b"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4522b08df6ce8c2fcef940bf8c35ef50","path":"/build/4522b08df6ce8c2fcef940bf8c35ef50.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"z8laFf693b"}],"key":"TYOhhi3YgG"}],"key":"okRbxQkDsk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = (phi1_r + 1.0j * phi1_i) * (phi2_r -1.0j * phi2_i)*np.exp(-1.0j * 20.0 * time)\n","key":"Pg8xvDGpZM"},{"type":"outputs","id":"CPs3LBhEgGHQ4gFBMPevU","children":[],"key":"LUuSKaw7jy"}],"key":"Zq5yIB0pfC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cx_phi1 = phi1_r + 1.0j * phi1_i\ncx_phi2 = phi2_r + 1.0j * phi2_i\n","key":"iyJnFDh3lW"},{"type":"outputs","id":"y8OaOl3fVLMvrW_45TLx7","children":[],"key":"yD8zVYvYSS"}],"key":"kt1lPvNduG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Parameters\ngamma1 = 1.0\ngamma2 = 1.0\nJ = 0.0\ng = 1.0\nxi = 1.0\nOmega = 20.0\n\n# Compute derivatives according to the model\nphi1_drv = -1.0j * (\n    cx_phi1 * (-1.0j * gamma1 + 1.0j * xi * n) +\n    (J + g * x) * np.exp(+1.0j * Omega * time) * cx_phi2\n)\n\nphi2_drv = -1.0j * (\n    cx_phi2 * (-1.0j * gamma2) +\n    (J + g * x) * np.exp(-1.0j * Omega * time) * cx_phi1\n)","key":"WtFGLMmVTb"},{"type":"outputs","id":"ofXKtzohdxSU1XwgLMNAj","children":[],"key":"kDaabBwElp"}],"key":"xbjljJnsBm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# More accurate derivative for non-uniform timesteps\ndt = np.diff(time)\ndphi1_dt = np.diff(cx_phi1) / dt\n# Add a point to match array sizes\ndphi1_dt = np.append(dphi1_dt, dphi1_dt[-1])","key":"fWwxxBuw1U"},{"type":"outputs","id":"5nP8i3YK0DGlA5zqnP0s7","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_30655/1696355221.py:3: RuntimeWarning: divide by zero encountered in divide\n  dphi1_dt = np.diff(cx_phi1) / dt\n/tmp/ipykernel_30655/1696355221.py:3: RuntimeWarning: invalid value encountered in divide\n  dphi1_dt = np.diff(cx_phi1) / dt\n"},"children":[],"key":"HGNtdHX7HY"}],"key":"jrxsxoVXqf"}],"key":"NY930vDXfG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot((phi1_drv - dphi1_dt).imag)\n# plt.xlim(0.0, 0.0025e6)\nplt.xscale('log')","key":"Wwg3Yd0u6T"},{"type":"outputs","id":"r0zIYNhWIKWPIh30kqZNW","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"81b4bfca4076cfa9bd3707c459fedc0a","path":"/build/81b4bfca4076cfa9bd3707c459fedc0a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"AMwuN39Qh4"}],"key":"X4R07bZhd7"}],"key":"qOLjS7FnzU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi1_drv.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"b6h6XhmVIt"},{"type":"outputs","id":"2LdClDLArYTkdlpB2xinP","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"CsjwyCjfW4"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d6c52c2ada8a3d0a0ec6a1111fcda10b","path":"/build/d6c52c2ada8a3d0a0ec6a1111fcda10b.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"DFHDb2mtHA"}],"key":"vcl2HjBTLZ"}],"key":"rX3TTo4gEv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def second_derivative(y, x):\n    \"\"\"\n    Second derivative for non-uniform grids.\n    Preserves array length.\n\n    Parameters\n    ----------\n    y : array_like\n        Function values y(x)\n    x : array_like\n        Grid points (not necessarily uniform)\n\n    Returns\n    -------\n    d2y : np.ndarray\n        Second derivative with same length as y\n    \"\"\"\n    y = np.asarray(y, dtype=float)\n    x = np.asarray(x, dtype=float)\n\n    if len(y) != len(x):\n        raise ValueError(\"x and y must have the same length\")\n    if len(y) < 3:\n        raise ValueError(\"Need at least 3 points\")\n\n    d2y = np.zeros_like(y)\n\n    # Interior points\n    for i in range(1, len(y) - 1):\n        h1 = x[i]   - x[i - 1]\n        h2 = x[i+1] - x[i]\n\n        d2y[i] = 2 * (\n            (y[i+1] - y[i]) / h2 -\n            (y[i]   - y[i-1]) / h1\n        ) / (h1 + h2)\n\n    # Left boundary (forward, non-uniform)\n    h1 = x[1] - x[0]\n    h2 = x[2] - x[1]\n    d2y[0] = 2 * (\n        (y[2] - y[1]) / h2 -\n        (y[1] - y[0]) / h1\n    ) / (h1 + h2)\n\n    # Right boundary (backward, non-uniform)\n    h1 = x[-2] - x[-3]\n    h2 = x[-1] - x[-2]\n    d2y[-1] = 2 * (\n        (y[-1] - y[-2]) / h2 -\n        (y[-2] - y[-3]) / h1\n    ) / (h1 + h2)\n\n    return d2y\n","key":"g365FMEjzo"},{"type":"outputs","id":"EEg3ymQCOY05xCPGm4AAA","children":[],"key":"QOYAUCnKu2"}],"key":"sW0ooZKHib"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ddot_x = second_derivative(x, time)","key":"yaeYYBpBbg"},{"type":"outputs","id":"fiCXoBi9yIgXHCnS4sqQ7","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: invalid value encountered in scalar divide\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:35: RuntimeWarning: invalid value encountered in scalar divide\n  (y[i]   - y[i-1]) / h1\n/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: divide by zero encountered in scalar divide\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:35: RuntimeWarning: divide by zero encountered in scalar divide\n  (y[i]   - y[i-1]) / h1\n/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: invalid value encountered in scalar subtract\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:42: RuntimeWarning: invalid value encountered in scalar divide\n  (y[2] - y[1]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:43: RuntimeWarning: invalid value encountered in scalar divide\n  (y[1] - y[0]) / h1\n/tmp/ipykernel_30655/3797952098.py:51: RuntimeWarning: invalid value encountered in scalar divide\n  (y[-2] - y[-3]) / h1\n"},"children":[],"key":"E2KA5xktvu"}],"key":"wHJnD3XSFt"}],"key":"Jzqy3B1yRK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = cx_phi1 * np.conj(cx_phi2) * np.exp(-1.0j * 20.0 * time)","key":"zNwm6jzB0e"},{"type":"outputs","id":"qW4naXjHcES3GoRhTolyc","children":[],"key":"w1AJnLeoA1"}],"key":"yeUWTqgWpQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_ode =ddot_x + 400.0 * x + 0.05* v","key":"rwd3ccSVSM"},{"type":"outputs","id":"fEtzdN3g3f2CvajKZukUR","children":[],"key":"LV00f8bFiN"}],"key":"hT1dxZ2TUb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(x_ode)\nplt.xlim(0.0, 0.1e6)","key":"vc9hD7ZDVX"},{"type":"outputs","id":"cMD9GwB0H0lcM4bULfqB7","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"TiTsaVqVWz"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"120d4558008fe3e89de0c8ff6a0938b2","path":"/build/120d4558008fe3e89de0c8ff6a0938b2.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"iUj2S9owiJ"}],"key":"n3uxLAHrHt"}],"key":"aAqkNJJ0I4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(-2*20.0*0.05*f.real)\nplt.xlim(0.0, 0.1e6)","key":"LJ6XIN6sdR"},{"type":"outputs","id":"xeDb1uqnqe4-cNIDHW329","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"Ay1ESUyAWu"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f44289349c995e03a668bffb2152f1e","path":"/build/9f44289349c995e03a668bffb2152f1e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"LvrgHnfS5L"}],"key":"M8KKglJ5O7"}],"key":"e3ItAZrVbl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(dphi1_dt.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"LrbtwqfRzJ"},{"type":"outputs","id":"e65mS-hrdkCCYeHCz2qxj","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"BAvNputYPz"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eefe40bf5c0396f5fea10a4cea08d910","path":"/build/eefe40bf5c0396f5fea10a4cea08d910.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"KB9HXTJ5xP"}],"key":"dJslDM9eY3"}],"key":"KiKcSx2n8B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi2_drv.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"i98ISdnwHY"},{"type":"outputs","id":"AlLjCwFqYNu7iUtDUfryy","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"bdWFvus63S"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"91dbf8c031055e4bb48ddcb540bcfa61","path":"/build/91dbf8c031055e4bb48ddcb540bcfa61.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"g2nm2wjBQX"}],"key":"nTxdMZTcdp"}],"key":"iBwe0DlT1k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(dphi2_dt.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"iqRzhA5zJB"},{"type":"outputs","id":"4OUBAaPzR8E0UxQu0Iy6s","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"lsIUyFQB7I"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"696b585a07ded37409dff35fe279b75f","path":"/build/696b585a07ded37409dff35fe279b75f.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"PiopJwYvje"}],"key":"IOKNt8CGXX"}],"key":"IDcjmwuc22"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dphi2_dt = np.diff(cx_phi2) / dt\n# Add a point to match array sizes\ndphi2_dt = np.append(dphi2_dt, dphi2_dt[-1])","key":"EIH8Y6lNCh"},{"type":"outputs","id":"nkPzKAJLue8kKaKxzx2Lo","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_6129/4041131784.py:1: RuntimeWarning: divide by zero encountered in divide\n  dphi2_dt = np.diff(cx_phi2) / dt\n/tmp/ipykernel_6129/4041131784.py:1: RuntimeWarning: invalid value encountered in divide\n  dphi2_dt = np.diff(cx_phi2) / dt\n"},"children":[],"key":"IhCmTX6mYj"}],"key":"sTOiiBttic"}],"key":"TiRmiwbXL3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot((phi2_drv - dphi2_dt).imag)\nplt.xscale('log')","key":"V4vyHj9Hqz"},{"type":"outputs","id":"sKiolSoKYk2kREp32Aueb","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"504884d1ac0307875f8b6416141ed8f4","path":"/build/504884d1ac0307875f8b6416141ed8f4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"FkfUUrOJcw"}],"key":"WGfVvDE1VZ"}],"key":"MIsm58UJBY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi2_drv.imag)\nplt.ylim(-1.5, 1.5)","key":"YmT7CGGL69"},{"type":"outputs","id":"6CEoVkKm6rVO2TpGNUD3J","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"(-1.5, 1.5)","content_type":"text/plain"}}},"children":[],"key":"OAFiTefKql"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f4c8c690c39c6a228518f901a910b9c1","path":"/build/f4c8c690c39c6a228518f901a910b9c1.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"nOxa6nnPl9"}],"key":"r5Yzmll9Xg"}],"key":"Ql1uZuALfd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, f.real)\nplt.xlim(70.0, 100.0)","key":"yEcD3umjG5"},{"type":"outputs","id":"N5UKEMXQabMJXPpXmwNXL","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(70.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"zHMZ9CeAh2"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e69abc70a78e438846d2998a3fd2896c","path":"/build/e69abc70a78e438846d2998a3fd2896c.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ZFdvi5MkOl"}],"key":"ejgBQYNuPJ"}],"key":"hpWQXDGP2P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"residue = np.gradient(v, time)-400.0 * x - 0.05 * v","key":"nOD1Myiehc"},{"type":"outputs","id":"c9UlW4QxuwGqN7XnXYkNq","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1309: RuntimeWarning: divide by zero encountered in divide\n  a = -(dx2) / (dx1 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1309: RuntimeWarning: invalid value encountered in divide\n  a = -(dx2) / (dx1 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1310: RuntimeWarning: divide by zero encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1310: RuntimeWarning: invalid value encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1311: RuntimeWarning: divide by zero encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1311: RuntimeWarning: invalid value encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1317: RuntimeWarning: invalid value encountered in add\n  out[tuple(slice1)] = a * f[tuple(slice2)] + b * f[tuple(slice3)] \\\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1327: RuntimeWarning: invalid value encountered in scalar divide\n  out[tuple(slice1)] = (f[tuple(slice2)] - f[tuple(slice3)]) / dx_0\n"},"children":[],"key":"WSiQh27z6V"}],"key":"PAIrnj0sx4"}],"key":"RqA6LSuZ7Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(residue - 2*20*0.05*f.real)\nplt.xlim(0.0, 10rpoy00.0)","key":"wbElxlep2G"},{"type":"outputs","id":"NjQ6Wd6J1D8jQ9MXldkiS","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"ZTfoqjYCHm"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"493b27e1086bb882cab7856043acd4b5","path":"/build/493b27e1086bb882cab7856043acd4b5.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Dhfs5IrtLo"}],"key":"UNG0pgm2m3"}],"key":"vwkbuHtuQu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, x)\nplt.xlim(0.0, 10.0)","key":"tjUN0K0RH0"},{"type":"outputs","id":"EANM3Hrs8qM4mWtvtq_yi","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(0.0, 10.0)","content_type":"text/plain"}}},"children":[],"key":"uYIxWecvdD"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c71c90c7e4d79fca1268e74873bc1283","path":"/build/c71c90c7e4d79fca1268e74873bc1283.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Z3Vdm2XzRn"}],"key":"oghiPoMu2u"}],"key":"Us3K12MxEt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, phi1_mod)\nplt.plot(time, phi2_mod)\nplt.xlim(-0.1, 30)\nplt.ylim(0.0, 10.0)\n# plt.xlim(400, 500","key":"SgOKkbl0Dg"},{"type":"outputs","id":"dUDHU6HBySDuUAeZPhRdU","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(0.0, 10.0)","content_type":"text/plain"}}},"children":[],"key":"I818dIcbFB"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"21ecdf2cadf557b63b1498e95f8bf86f","path":"/build/21ecdf2cadf557b63b1498e95f8bf86f.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Pa5IuvhJfP"}],"key":"mPM2KoyWu8"}],"key":"pW9AO8kAyo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"gPZg4SR7SM"},{"type":"outputs","id":"Yjqisf1d95u22p1ICdkei","children":[],"key":"pWkDyCJQCJ"}],"key":"AMkPpkT1XL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, n)","key":"ufNkkh0tvm"},{"type":"outputs","id":"f56fkdsZ_cL1EwZTRhADy","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eb58af7de5248df59f92853f6d4fc84a","path":"/build/eb58af7de5248df59f92853f6d4fc84a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"EcEulxCnxh"}],"key":"HYb5IJ12yq"}],"key":"SSct8lyvJR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mask = time > 300\ntime_new = time[mask]\nphi1_i_new = phi1_i[mask]\nphi1_r_new = phi1_r[mask]","key":"g1SEuLIhhO"},{"type":"outputs","id":"CUBMycy9tPdLgjicC_Oqv","children":[],"key":"BHov4AIBxE"}],"key":"MFyw0uNNy9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"delta_t = time[1]-time[0]","key":"QG9CB3FDIs"},{"type":"outputs","id":"2fhccFXG4HO5Ifzt3hw-r","children":[],"key":"rjEXa3T1jh"}],"key":"EhBpHaN4M9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.fft import fft, fft2\n\nphi_fft = fft(phi1_r_new +1.0j*phi1_i_new)","key":"JhbJJf1elw"},{"type":"outputs","id":"CdC8SJyG6r8isfTP46a-r","children":[],"key":"L4C3sK2qUX"}],"key":"DTnpERRWIB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(np.roll(np.arange(len(phi_fft))/(len(phi_fft) * delta_t), int(len(phi_fft)/2)), abs(phi_fft)**2/len(phi_fft))\nplt.yscale('log')","key":"VX9WB9d8MY"},{"type":"outputs","id":"L-ByZ3FLVHbnuHLbMcp2Q","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"822091d31f7b6a86f68b6207311ce9ce","path":"/build/822091d31f7b6a86f68b6207311ce9ce.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"MQmBx0JloP"}],"key":"t3znK7qEpH"}],"key":"Q6uiTJa1MX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.xlim(0.0, 20.0)\nplt.plot(time, phi1_mod)\nplt.plot(time, phi2_mod)\n","key":"Nw7LC2RO0B"},{"type":"outputs","id":"b22oI88E192ODpbWsN3Sd","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f203c9389cbc92efdd094e819290774b","path":"/build/f203c9389cbc92efdd094e819290774b.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"gawzJw1cVq"}],"key":"kIiEXpiaeZ"}],"key":"pdYLZXlAuy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, n)\nplt.xlim(400.0, 500.0)\n# plt.yscale('log')","key":"I7ta9d1uRg"},{"type":"outputs","id":"kSe77tkTkZFe8DVhI13To","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":154,"metadata":{},"data":{"text/plain":{"content":"(400.0, 500.0)","content_type":"text/plain"}}},"children":[],"key":"ZXfM52Wlay"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"64ed39662032d9c2b545a052319514f4","path":"/build/64ed39662032d9c2b545a052319514f4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"JULMjcYkzU"}],"key":"Bs6WfASmKk"}],"key":"PjdrOpR4ag"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, x)\nplt.xlim(300.0, 310.0)","key":"oHph2dVT4A"},{"type":"outputs","id":"1s1uTny9tHkpGp6iv0Wwk","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":156,"metadata":{},"data":{"text/plain":{"content":"(300.0, 310.0)","content_type":"text/plain"}}},"children":[],"key":"qc5kc69VTS"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a451b8711f4dd291a83e0bceccc3d9f0","path":"/build/a451b8711f4dd291a83e0bceccc3d9f0.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ixc2roISXQ"}],"key":"GkVlRZnd4a"}],"key":"ESh0APdXo6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_folder_path = \"/home/ruiz/Documents/polaritons/data/processed/\"\ndata = pd.read_csv(data_folder_path + \"nonResonantSweepBuilt.dat\", delimiter= \"\\t\", header = None).iloc[:, :-1]","key":"SiqKfgVZa8"},{"type":"outputs","id":"NZfHr1ylJ5hZubQvR2B2f","children":[],"key":"ruhbRP00jB"}],"key":"Not7oqOLR5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data.head()","key":"U3jzVU7t1W"},{"type":"outputs","id":"nlIQJJFwoxjXEaNXT9nSr","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>6.174560e-07</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.306122</td>\n      <td>0.000000</td>\n      <td>0.093711</td>\n      <td>0.000000</td>\n      <td>1.530610e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.612245</td>\n      <td>0.000000</td>\n      <td>0.374844</td>\n      <td>0.000000</td>\n      <td>3.061230e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.918367</td>\n      <td>0.121411</td>\n      <td>0.670727</td>\n      <td>0.162630</td>\n      <td>3.292760e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1.224490</td>\n      <td>0.422035</td>\n      <td>0.741610</td>\n      <td>0.632542</td>\n      <td>2.582170e-01</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"          0         1         2         3             4  5\n0  0.000000  0.000000  0.000000  0.000000  6.174560e-07  0\n1  0.306122  0.000000  0.093711  0.000000  1.530610e-01  0\n2  0.612245  0.000000  0.374844  0.000000  3.061230e-01  0\n3  0.918367  0.121411  0.670727  0.162630  3.292760e-01  0\n4  1.224490  0.422035  0.741610  0.632542  2.582170e-01  0","content_type":"text/plain"}}},"children":[],"key":"wq9l9VSgAW"}],"key":"DfqJKlw7Wv"}],"key":"qemjJkVilx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(data[0], data[2], label = r'$\\frac{\\langle \\vert \\phi_1\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.scatter(data[0], data[1], label = r'$\\frac{\\langle \\vert \\phi_2\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.scatter(data[0], np.sqrt(data[3]/2))\nplt.scatter(data[0], data[4])\nplt.scatter(data[0], data[5])\nplt.plot(data[0], data[2], label = r'$\\frac{\\langle \\vert \\phi_1\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.plot(data[0], data[1], label = r'$\\frac{\\langle \\vert \\phi_2\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.plot(data[0], np.sqrt(data[3]/2))\nplt.plot(data[0], data[4])\nplt.plot(data[0], data[5])\nplt.grid(True)\nplt.xlabel('Magnitud Normalizada')\nplt.ylabel('Potencia')\nplt.legend()\nplt.ylim(0.0, 3.0)\n\n","key":"abrJ81VsDO"},{"type":"outputs","id":"Gs2qohPTXo3Oz32VAtkeA","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"(0.0, 3.0)","content_type":"text/plain"}}},"children":[],"key":"HhoLLtzu9G"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e4a72c821dd4965cc529478b6e90709e","path":"/build/e4a72c821dd4965cc529478b6e90709e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"UxkexvoSlg"}],"key":"jOt4aZZp5a"}],"key":"ia83KpumH5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"qKp4Z8E9UW"},{"type":"outputs","id":"V5K-yeBjAtUycLzwqatWE","children":[],"key":"OoqQt9uUsK"}],"key":"TztBReD2qW"}],"key":"QjY5UZIgnL"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Cpp Notebook","url":"/cpp-notebook","group":"Exploration"},"next":{"title":"Two Site Resonant","url":"/two-site-resonant","group":"Exploration"}}},"domain":"http://localhost:3002"}