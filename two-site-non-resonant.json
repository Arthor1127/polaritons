{"version":3,"kind":"Notebook","sha256":"cc377eeaa5677e4491813828b45851b2cf31362287b8dc142f083c07ab099c99","slug":"two-site-non-resonant","location":"/notebooks/exploration/two_site_non_resonant.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"python3","display_name":"quantum","language":"python"},"authors":[{"id":"Arturo Ruiz","name":"Arturo Ruiz"},{"id":"Gonzalo Usaj","name":"Gonzalo Usaj"}],"github":"https://github.com/Arthor1127/polaritons","affiliations":[{"id":"Instituto Balseiro","name":"Instituto Balseiro"},{"id":"Comisión Nacional de Energía Atómica","name":"Comisión Nacional de Energía Atómica"}],"numbering":{"title":{"offset":2}},"source_url":"https://github.com/Arthor1127/polaritons/blob/main/notebooks/exploration/two_site_non_resonant.ipynb","edit_url":"https://github.com/Arthor1127/polaritons/edit/main/notebooks/exploration/two_site_non_resonant.ipynb","exports":[{"format":"ipynb","filename":"two_site_non_resonant.ipynb","url":"/build/two_site_non_resonan-f29f4859554bdc35e54662e833072167.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt \nimport scienceplots \nplt.style.use(['science', 'no-latex', 'notebook'])","key":"p3D1QMW3RA"},{"type":"outputs","id":"wpkilfl4dJETywdsI04OF","children":[],"key":"pALbdlcR2Q"}],"key":"xUQobvYNBU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_folder_path = \"/home/ruiz/Documents/polaritons/scripts/cpp/\"\ndata = pd.read_csv(data_folder_path + \"output_time.dat\", delimiter= \"\\t\", header = None).iloc[:, :-1]","key":"QX21tVEQH2"},{"type":"outputs","id":"uRgbxAT8ri7OeFdvDDatm","children":[],"key":"qX0PCqwGGn"}],"key":"dsgoPL8ckm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data.head()","key":"V1y8t9js0T"},{"type":"outputs","id":"6GhHpMLQXJpD5FkAzXumx","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n      <th>6</th>\n      <th>7</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.000000</td>\n      <td>0.229257</td>\n      <td>0.521318</td>\n      <td>4.29477</td>\n      <td>7.13006</td>\n      <td>6.79031</td>\n      <td>95.5826</td>\n      <td>0.400246</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.000173</td>\n      <td>0.237630</td>\n      <td>0.516260</td>\n      <td>4.29464</td>\n      <td>7.12856</td>\n      <td>6.80679</td>\n      <td>95.1134</td>\n      <td>0.980671</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.000346</td>\n      <td>0.246060</td>\n      <td>0.511266</td>\n      <td>4.29450</td>\n      <td>7.12704</td>\n      <td>6.82319</td>\n      <td>94.6431</td>\n      <td>1.450300</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"          0         1         2        3        4        5        6         7\n0  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n1  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n2  0.000000  0.229257  0.521318  4.29477  7.13006  6.79031  95.5826  0.400246\n3  0.000173  0.237630  0.516260  4.29464  7.12856  6.80679  95.1134  0.980671\n4  0.000346  0.246060  0.511266  4.29450  7.12704  6.82319  94.6431  1.450300","content_type":"text/plain"}}},"children":[],"key":"Az0F2U6ZiW"}],"key":"OGvj9G5YE4"}],"key":"N02STsFJlL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"time = data[0].to_numpy(dtype = float)\nphi1_r = data[1].to_numpy(dtype = float)\nphi1_i = data[2].to_numpy(dtype = float)\nphi2_r = data[3].to_numpy(dtype = float)\nphi2_i = data[4].to_numpy(dtype = float)\nx = data[5].to_numpy(dtype = float)\nv = data[6].to_numpy(dtype = float)\nn = data[7].to_numpy(dtype = float)","key":"OqQu9lOgsQ"},{"type":"outputs","id":"exvji_Zki-wcrXaUbIUIX","children":[],"key":"swpXey1pM2"}],"key":"lLkjhu51ru"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"phi1_mod = phi1_r**2 + phi1_i**2\nphi2_mod = phi2_r**2 + phi2_i**2","key":"X7a8zQo7i3"},{"type":"outputs","id":"RZ4J43_TOqnHu2_66jhxw","children":[],"key":"jwIIyORfVH"}],"key":"j0qQ9vyyrb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, phi1_i)\nplt.plot(time, phi1_r)\nplt.plot(time, phi2_i)\nplt.plot(time, phi2_r)\nplt.plot(time, n)\n# plt.xlim(400.0, 410.0)\n# plt.xlim(300, 500)\nplt.xlim(-1.0, 100)","key":"mMtEntYcpT"},{"type":"outputs","id":"H6UdJTfxLNNvY_FfIz1FH","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"(-1.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"TIE93x68Ai"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4522b08df6ce8c2fcef940bf8c35ef50","path":"/build/4522b08df6ce8c2fcef940bf8c35ef50.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"yfy1HO98VG"}],"key":"IJpiird6p8"}],"key":"PjkMpjTS0q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = (phi1_r + 1.0j * phi1_i) * (phi2_r -1.0j * phi2_i)*np.exp(-1.0j * 20.0 * time)\n","key":"RyDBmcwuN6"},{"type":"outputs","id":"6a06KvQkXRj_zsndFSL7z","children":[],"key":"RoOHqCn5Vy"}],"key":"eqEXR7xqix"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cx_phi1 = phi1_r + 1.0j * phi1_i\ncx_phi2 = phi2_r + 1.0j * phi2_i\n","key":"AhCBR635Iy"},{"type":"outputs","id":"0D5Qjs2Xse5sL1BWszW11","children":[],"key":"pNaXuu6Ora"}],"key":"tuJFfE3YfM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Parameters\ngamma1 = 1.0\ngamma2 = 1.0\nJ = 0.0\ng = 1.0\nxi = 1.0\nOmega = 20.0\n\n# Compute derivatives according to the model\nphi1_drv = -1.0j * (\n    cx_phi1 * (-1.0j * gamma1 + 1.0j * xi * n) +\n    (J + g * x) * np.exp(+1.0j * Omega * time) * cx_phi2\n)\n\nphi2_drv = -1.0j * (\n    cx_phi2 * (-1.0j * gamma2) +\n    (J + g * x) * np.exp(-1.0j * Omega * time) * cx_phi1\n)","key":"Z8F40WeLMM"},{"type":"outputs","id":"rvFYeHj1uKdGU6PY8C2ZR","children":[],"key":"hWyXXxTNmq"}],"key":"QCzVSH82Kx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# More accurate derivative for non-uniform timesteps\ndt = np.diff(time)\ndphi1_dt = np.diff(cx_phi1) / dt\n# Add a point to match array sizes\ndphi1_dt = np.append(dphi1_dt, dphi1_dt[-1])","key":"aW3j8hFNT1"},{"type":"outputs","id":"WfooL4B5nhj8BZno4vsRv","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_30655/1696355221.py:3: RuntimeWarning: divide by zero encountered in divide\n  dphi1_dt = np.diff(cx_phi1) / dt\n/tmp/ipykernel_30655/1696355221.py:3: RuntimeWarning: invalid value encountered in divide\n  dphi1_dt = np.diff(cx_phi1) / dt\n"},"children":[],"key":"Gdm0fOu1Un"}],"key":"uQBelp5E2b"}],"key":"INWMTRxIt7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot((phi1_drv - dphi1_dt).imag)\n# plt.xlim(0.0, 0.0025e6)\nplt.xscale('log')","key":"zKZy9416dY"},{"type":"outputs","id":"JJrn-GbePYudDwRv6Xp0x","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"81b4bfca4076cfa9bd3707c459fedc0a","path":"/build/81b4bfca4076cfa9bd3707c459fedc0a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"z2f1eyNgF3"}],"key":"XAJtDmIcrG"}],"key":"M9NhaPawRQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi1_drv.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"QuiU1ckFUr"},{"type":"outputs","id":"bpmrXrclFIe5lMg4zasBB","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"FYQ9L3Bju2"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d6c52c2ada8a3d0a0ec6a1111fcda10b","path":"/build/d6c52c2ada8a3d0a0ec6a1111fcda10b.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"lyrMioMS4S"}],"key":"W4NOseR7gc"}],"key":"ZYp3IEwXD5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def second_derivative(y, x):\n    \"\"\"\n    Second derivative for non-uniform grids.\n    Preserves array length.\n\n    Parameters\n    ----------\n    y : array_like\n        Function values y(x)\n    x : array_like\n        Grid points (not necessarily uniform)\n\n    Returns\n    -------\n    d2y : np.ndarray\n        Second derivative with same length as y\n    \"\"\"\n    y = np.asarray(y, dtype=float)\n    x = np.asarray(x, dtype=float)\n\n    if len(y) != len(x):\n        raise ValueError(\"x and y must have the same length\")\n    if len(y) < 3:\n        raise ValueError(\"Need at least 3 points\")\n\n    d2y = np.zeros_like(y)\n\n    # Interior points\n    for i in range(1, len(y) - 1):\n        h1 = x[i]   - x[i - 1]\n        h2 = x[i+1] - x[i]\n\n        d2y[i] = 2 * (\n            (y[i+1] - y[i]) / h2 -\n            (y[i]   - y[i-1]) / h1\n        ) / (h1 + h2)\n\n    # Left boundary (forward, non-uniform)\n    h1 = x[1] - x[0]\n    h2 = x[2] - x[1]\n    d2y[0] = 2 * (\n        (y[2] - y[1]) / h2 -\n        (y[1] - y[0]) / h1\n    ) / (h1 + h2)\n\n    # Right boundary (backward, non-uniform)\n    h1 = x[-2] - x[-3]\n    h2 = x[-1] - x[-2]\n    d2y[-1] = 2 * (\n        (y[-1] - y[-2]) / h2 -\n        (y[-2] - y[-3]) / h1\n    ) / (h1 + h2)\n\n    return d2y\n","key":"usTJLtpxKw"},{"type":"outputs","id":"1XuBvkQ6Q_EXYzTNHPqb4","children":[],"key":"ed3YTHzb8O"}],"key":"oV60Xw6Mwk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ddot_x = second_derivative(x, time)","key":"YBDlJps5pO"},{"type":"outputs","id":"nGNwv6yf1WwwBr0YAkSEN","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: invalid value encountered in scalar divide\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:35: RuntimeWarning: invalid value encountered in scalar divide\n  (y[i]   - y[i-1]) / h1\n/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: divide by zero encountered in scalar divide\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:35: RuntimeWarning: divide by zero encountered in scalar divide\n  (y[i]   - y[i-1]) / h1\n/tmp/ipykernel_30655/3797952098.py:34: RuntimeWarning: invalid value encountered in scalar subtract\n  (y[i+1] - y[i]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:42: RuntimeWarning: invalid value encountered in scalar divide\n  (y[2] - y[1]) / h2 -\n/tmp/ipykernel_30655/3797952098.py:43: RuntimeWarning: invalid value encountered in scalar divide\n  (y[1] - y[0]) / h1\n/tmp/ipykernel_30655/3797952098.py:51: RuntimeWarning: invalid value encountered in scalar divide\n  (y[-2] - y[-3]) / h1\n"},"children":[],"key":"f1j6ejDsAF"}],"key":"q9h5ptGpcS"}],"key":"Dgkwt12YZm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = cx_phi1 * np.conj(cx_phi2) * np.exp(-1.0j * 20.0 * time)","key":"QafrMue5E8"},{"type":"outputs","id":"hKYPYyuEDTtcZeDL2rSIc","children":[],"key":"Q6EJ51ScQs"}],"key":"wUeRGmBlk5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_ode =ddot_x + 400.0 * x + 0.05* v","key":"i6pnLj7JFc"},{"type":"outputs","id":"UPFBKDvmq7Gg0FEdTC2A8","children":[],"key":"ZqoYMTQ7Fs"}],"key":"M3brKxdSLz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(x_ode)\nplt.xlim(0.0, 0.1e6)","key":"DGzbt7ihi6"},{"type":"outputs","id":"rmgXRcsA-WH5uTSDh3tId","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"fY3BaiGrqq"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"120d4558008fe3e89de0c8ff6a0938b2","path":"/build/120d4558008fe3e89de0c8ff6a0938b2.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ZtYsPiL5Kc"}],"key":"G4Ncc8nQ1o"}],"key":"KiPSQ54UCQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(-2*20.0*0.05*f.real)\nplt.xlim(0.0, 0.1e6)","key":"Pklpi95Pgw"},{"type":"outputs","id":"3ixpnhFOIHg1dcurNb8Bz","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"RSGy90p7JY"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9f44289349c995e03a668bffb2152f1e","path":"/build/9f44289349c995e03a668bffb2152f1e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"M8eshJnWaT"}],"key":"qUF64SLkLl"}],"key":"wcTRoloiGK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(dphi1_dt.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"rbo6CGy6by"},{"type":"outputs","id":"Az4wJOrKtqYW3EsX63wD-","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"ZAnaaEcXSh"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eefe40bf5c0396f5fea10a4cea08d910","path":"/build/eefe40bf5c0396f5fea10a4cea08d910.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"E62LMh2cdY"}],"key":"xcmQ37Q1f5"}],"key":"tBgq8ESdF9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi2_drv.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"yq8hDbgJyt"},{"type":"outputs","id":"NEkHARFXp_1F9q0WwIGsF","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"W3OzQ06wa2"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"91dbf8c031055e4bb48ddcb540bcfa61","path":"/build/91dbf8c031055e4bb48ddcb540bcfa61.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"F8DMlpahAU"}],"key":"nv2IvKQGnk"}],"key":"lNo2QdbyPD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(dphi2_dt.imag)\nplt.ylim(-1.0, 1.0)\nplt.xlim(0.0, 0.1e6)","key":"WbtzCYmzBp"},{"type":"outputs","id":"C19MLPZUmoG63Rtjh9561","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100000.0)","content_type":"text/plain"}}},"children":[],"key":"nqf9RVRAV4"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"696b585a07ded37409dff35fe279b75f","path":"/build/696b585a07ded37409dff35fe279b75f.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"xEX78Vdtcg"}],"key":"IfIPtx8udN"}],"key":"aezyzLrZoU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dphi2_dt = np.diff(cx_phi2) / dt\n# Add a point to match array sizes\ndphi2_dt = np.append(dphi2_dt, dphi2_dt[-1])","key":"YbaaXLt5DH"},{"type":"outputs","id":"lkXySSE5dRKod4llhKEvv","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_6129/4041131784.py:1: RuntimeWarning: divide by zero encountered in divide\n  dphi2_dt = np.diff(cx_phi2) / dt\n/tmp/ipykernel_6129/4041131784.py:1: RuntimeWarning: invalid value encountered in divide\n  dphi2_dt = np.diff(cx_phi2) / dt\n"},"children":[],"key":"zBF3GWPhCv"}],"key":"Yz4fyuvjMA"}],"key":"a0tr703a3m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot((phi2_drv - dphi2_dt).imag)\nplt.xscale('log')","key":"eeP1n0aJBy"},{"type":"outputs","id":"h0qq6SeBwotRa_fdkkeNK","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"504884d1ac0307875f8b6416141ed8f4","path":"/build/504884d1ac0307875f8b6416141ed8f4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Sxq5mVEGFf"}],"key":"xnJpYQXbh1"}],"key":"XU7sCu79Q6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(phi2_drv.imag)\nplt.ylim(-1.5, 1.5)","key":"VNEENqI17j"},{"type":"outputs","id":"770RrHHgeO1aIwPPevoNY","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"(-1.5, 1.5)","content_type":"text/plain"}}},"children":[],"key":"tIUzv5DGh3"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f4c8c690c39c6a228518f901a910b9c1","path":"/build/f4c8c690c39c6a228518f901a910b9c1.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"zZFut1JMJE"}],"key":"eFpgDlxLAj"}],"key":"f5msZMNptX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, f.real)\nplt.xlim(70.0, 100.0)","key":"EOac49B8t8"},{"type":"outputs","id":"Q_YCQBLHMvYY3uM__GRrO","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(70.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"u4h0WBtn6m"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e69abc70a78e438846d2998a3fd2896c","path":"/build/e69abc70a78e438846d2998a3fd2896c.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"wCPbXp4eRS"}],"key":"UqshMhqCDy"}],"key":"sKZTglxnjR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"residue = np.gradient(v, time)-400.0 * x - 0.05 * v","key":"mjxv2it7Bo"},{"type":"outputs","id":"tYta9nnfEaeZGJgOMr94l","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1309: RuntimeWarning: divide by zero encountered in divide\n  a = -(dx2) / (dx1 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1309: RuntimeWarning: invalid value encountered in divide\n  a = -(dx2) / (dx1 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1310: RuntimeWarning: divide by zero encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1310: RuntimeWarning: invalid value encountered in divide\n  b = (dx2 - dx1) / (dx1 * dx2)\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1311: RuntimeWarning: divide by zero encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1311: RuntimeWarning: invalid value encountered in divide\n  c = dx1 / (dx2 * (dx1 + dx2))\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1317: RuntimeWarning: invalid value encountered in add\n  out[tuple(slice1)] = a * f[tuple(slice2)] + b * f[tuple(slice3)] \\\n/home/ruiz/miniconda3/envs/quantum/lib/python3.14/site-packages/numpy/lib/_function_base_impl.py:1327: RuntimeWarning: invalid value encountered in scalar divide\n  out[tuple(slice1)] = (f[tuple(slice2)] - f[tuple(slice3)]) / dx_0\n"},"children":[],"key":"bCsyeOuvez"}],"key":"a0x8IaKadX"}],"key":"cCXJaTqjxb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(residue - 2*20*0.05*f.real)\nplt.xlim(0.0, 10rpoy00.0)","key":"xhUmiZfiad"},{"type":"outputs","id":"1PhpQGyPcJGpdrsouUtxj","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"(0.0, 100.0)","content_type":"text/plain"}}},"children":[],"key":"vpCCEpNPB2"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"493b27e1086bb882cab7856043acd4b5","path":"/build/493b27e1086bb882cab7856043acd4b5.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"WH16CkwtFj"}],"key":"krKhtqhIe9"}],"key":"TGRlSxwRid"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, x)\nplt.xlim(0.0, 10.0)","key":"jbr4ciT0oL"},{"type":"outputs","id":"7AApGEXo9oj2wUtdco052","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(0.0, 10.0)","content_type":"text/plain"}}},"children":[],"key":"CF8DklESms"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c71c90c7e4d79fca1268e74873bc1283","path":"/build/c71c90c7e4d79fca1268e74873bc1283.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"poesEua9ZZ"}],"key":"c0eGQMmAXS"}],"key":"SgaM5GLD9I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, phi1_mod)\nplt.plot(time, phi2_mod)\nplt.xlim(-0.1, 30)\nplt.ylim(0.0, 10.0)\n# plt.xlim(400, 500","key":"V30pnhxlwd"},{"type":"outputs","id":"nndcmlVO3nEAmNWedOwmz","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"(0.0, 10.0)","content_type":"text/plain"}}},"children":[],"key":"DhPMQiH83l"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"21ecdf2cadf557b63b1498e95f8bf86f","path":"/build/21ecdf2cadf557b63b1498e95f8bf86f.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"PL3ZtXQtAc"}],"key":"DDY9STCm5y"}],"key":"XQnKTFWhkJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"awN1FlXJXP"},{"type":"outputs","id":"rw_SjrajJPNrZsI-WrF4B","children":[],"key":"fg2PsvF8Uh"}],"key":"jEVSuW9RjN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, n)","key":"U0FXVoTKR6"},{"type":"outputs","id":"NaWZVABs7wldss6FJqw7E","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eb58af7de5248df59f92853f6d4fc84a","path":"/build/eb58af7de5248df59f92853f6d4fc84a.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"H8RgNpHvWb"}],"key":"fP8NiwQR5b"}],"key":"leXlrCIBUe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mask = time > 300\ntime_new = time[mask]\nphi1_i_new = phi1_i[mask]\nphi1_r_new = phi1_r[mask]","key":"ZUtEkDUZw8"},{"type":"outputs","id":"s7MVp5g4Hnk3zrT6Fuzba","children":[],"key":"Pfa97OZM5B"}],"key":"WWWC8o7ydO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"delta_t = time[1]-time[0]","key":"kh5WbPsBmm"},{"type":"outputs","id":"HzYTlEsN2tJvG-aQwWdws","children":[],"key":"w1r8KWUBN8"}],"key":"RnwfNmcf7P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.fft import fft, fft2\n\nphi_fft = fft(phi1_r_new +1.0j*phi1_i_new)","key":"ccq8M68wYz"},{"type":"outputs","id":"d3JCfdjfkl2G4ty3iE8S3","children":[],"key":"bA2uJcDEb7"}],"key":"uM81PwpC9C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(np.roll(np.arange(len(phi_fft))/(len(phi_fft) * delta_t), int(len(phi_fft)/2)), abs(phi_fft)**2/len(phi_fft))\nplt.yscale('log')","key":"s4TZdVEOk6"},{"type":"outputs","id":"ApGVEgzA4TDrjNxXgP81a","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"822091d31f7b6a86f68b6207311ce9ce","path":"/build/822091d31f7b6a86f68b6207311ce9ce.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"TYuKzCcAOF"}],"key":"irSlGjeUX1"}],"key":"E2STUDAaQP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.xlim(0.0, 20.0)\nplt.plot(time, phi1_mod)\nplt.plot(time, phi2_mod)\n","key":"OaxUuceFx8"},{"type":"outputs","id":"jvOrYvCtA72s01YxGHwpX","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f203c9389cbc92efdd094e819290774b","path":"/build/f203c9389cbc92efdd094e819290774b.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Itghq7lYTX"}],"key":"A0MkQa9F3L"}],"key":"JGrBZuHtMM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, n)\nplt.xlim(400.0, 500.0)\n# plt.yscale('log')","key":"qQoIgnJgjs"},{"type":"outputs","id":"e22d9wWmDZf4PzwWQqUt2","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":154,"metadata":{},"data":{"text/plain":{"content":"(400.0, 500.0)","content_type":"text/plain"}}},"children":[],"key":"iSLsDCZrOk"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"64ed39662032d9c2b545a052319514f4","path":"/build/64ed39662032d9c2b545a052319514f4.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"S7PFEXD2k8"}],"key":"NtlhL3zZIJ"}],"key":"qfr7udjFJi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(time, x)\nplt.xlim(300.0, 310.0)","key":"C87bwiEYN4"},{"type":"outputs","id":"1E5qKrFDhTNN6B-qVfy0-","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":156,"metadata":{},"data":{"text/plain":{"content":"(300.0, 310.0)","content_type":"text/plain"}}},"children":[],"key":"Usd2mT0tsQ"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a451b8711f4dd291a83e0bceccc3d9f0","path":"/build/a451b8711f4dd291a83e0bceccc3d9f0.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Wy1y8K5fff"}],"key":"K3EOC0OKDB"}],"key":"zwXo7ykaoS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_folder_path = \"/home/ruiz/Documents/polaritons/data/processed/\"\ndata = pd.read_csv(data_folder_path + \"nonResonantSweepBuilt.dat\", delimiter= \"\\t\", header = None).iloc[:, :-1]","key":"aCjfWcwhiP"},{"type":"outputs","id":"cvuna8VYXlVUZkp-nyAon","children":[],"key":"ul6PlyBMnn"}],"key":"fDt78FBgH5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data.head()","key":"OTyacO1yDi"},{"type":"outputs","id":"LU2RK3URMKLPhpaMGFFtl","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>6.174560e-07</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.306122</td>\n      <td>0.000000</td>\n      <td>0.093711</td>\n      <td>0.000000</td>\n      <td>1.530610e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.612245</td>\n      <td>0.000000</td>\n      <td>0.374844</td>\n      <td>0.000000</td>\n      <td>3.061230e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.918367</td>\n      <td>0.121411</td>\n      <td>0.670727</td>\n      <td>0.162630</td>\n      <td>3.292760e-01</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1.224490</td>\n      <td>0.422035</td>\n      <td>0.741610</td>\n      <td>0.632542</td>\n      <td>2.582170e-01</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"          0         1         2         3             4  5\n0  0.000000  0.000000  0.000000  0.000000  6.174560e-07  0\n1  0.306122  0.000000  0.093711  0.000000  1.530610e-01  0\n2  0.612245  0.000000  0.374844  0.000000  3.061230e-01  0\n3  0.918367  0.121411  0.670727  0.162630  3.292760e-01  0\n4  1.224490  0.422035  0.741610  0.632542  2.582170e-01  0","content_type":"text/plain"}}},"children":[],"key":"ezpUig4ce6"}],"key":"gxl5J1JK00"}],"key":"xQGvTwUCqb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(data[0], data[2], label = r'$\\frac{\\langle \\vert \\phi_1\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.scatter(data[0], data[1], label = r'$\\frac{\\langle \\vert \\phi_2\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.scatter(data[0], np.sqrt(data[3]/2))\nplt.scatter(data[0], data[4])\nplt.scatter(data[0], data[5])\nplt.plot(data[0], data[2], label = r'$\\frac{\\langle \\vert \\phi_1\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.plot(data[0], data[1], label = r'$\\frac{\\langle \\vert \\phi_2\\vert^2 \\rangle}{\\phi_s^2}$')\nplt.plot(data[0], np.sqrt(data[3]/2))\nplt.plot(data[0], data[4])\nplt.plot(data[0], data[5])\nplt.grid(True)\nplt.xlabel('Magnitud Normalizada')\nplt.ylabel('Potencia')\nplt.legend()\nplt.ylim(0.0, 3.0)\n\n","key":"VaxePsYFAL"},{"type":"outputs","id":"NfB5RysfOm2LnZ_VbIR-9","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"(0.0, 3.0)","content_type":"text/plain"}}},"children":[],"key":"mPKG0mxtVF"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e4a72c821dd4965cc529478b6e90709e","path":"/build/e4a72c821dd4965cc529478b6e90709e.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"GRNrX2bDtt"}],"key":"OZX3tkIMJM"}],"key":"qyX0a7QcFw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"e7F0rLXt87"},{"type":"outputs","id":"vtLGZLZ_lsca7gy_ZbggL","children":[],"key":"HNAOYUr8FF"}],"key":"tfJ2puGoof"}],"key":"Dcf68oUkGI"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Cpp Notebook","url":"/cpp-notebook","group":"Exploration"},"next":{"title":"Two Site Resonant","url":"/two-site-resonant","group":"Exploration"}}},"domain":"http://localhost:3003"}